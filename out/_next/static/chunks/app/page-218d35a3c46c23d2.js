(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5573:function(e,s,t){Promise.resolve().then(t.bind(t,6219))},6219:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return sQ}});var a=t(7437),r=t(2265),l=t(7053),n=t(535),i=t(1994),c=t(3335);function o(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,c.m6)((0,i.W)(s))}let d=(e,s,t)=>{let a=atob(e),r=Array(a.length);for(let e=0;e<a.length;e++)r[e]=a.charCodeAt(e);return new File([new Blob([new Uint8Array(r)],{type:t})],s,{type:t})},m=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:s,variant:t,size:r,asChild:n=!1,...i}=e,c=n?l.g7:"button";return(0,a.jsx)(c,{"data-slot":"button",className:o(m({variant:t,size:r,className:s})),...i})}function x(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function h(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function p(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:o("leading-none font-semibold",s),...t})}function g(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:o("text-muted-foreground text-sm",s),...t})}function f(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:o("px-6",s),...t})}let j=(0,n.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function v(e){let{className:s,variant:t,asChild:r=!1,...n}=e,i=r?l.g7:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:o(j({variant:t}),s),...n})}function N(e){let{className:s,type:t,...r}=e;return(0,a.jsx)("input",{type:t,"data-slot":"input",className:o("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...r})}var y=t(6394);function w(e){let{className:s,...t}=e;return(0,a.jsx)(y.f,{"data-slot":"label",className:o("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}var b=t(1312);function k(e){let{className:s,...t}=e;return(0,a.jsx)(b.fC,{"data-slot":"tabs",className:o("flex flex-col gap-2",s),...t})}function C(e){let{className:s,...t}=e;return(0,a.jsx)(b.aV,{"data-slot":"tabs-list",className:o("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function S(e){let{className:s,...t}=e;return(0,a.jsx)(b.xz,{"data-slot":"tabs-trigger",className:o("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function z(e){let{className:s,...t}=e;return(0,a.jsx)(b.VY,{"data-slot":"tabs-content",className:o("flex-1 outline-none",s),...t})}var _=t(9027),A=t(2489);function Z(e){let{...s}=e;return(0,a.jsx)(_.fC,{"data-slot":"dialog",...s})}function U(e){let{...s}=e;return(0,a.jsx)(_.xz,{"data-slot":"dialog-trigger",...s})}function E(e){let{...s}=e;return(0,a.jsx)(_.h_,{"data-slot":"dialog-portal",...s})}function F(e){let{className:s,...t}=e;return(0,a.jsx)(_.aV,{"data-slot":"dialog-overlay",className:o("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function T(e){let{className:s,children:t,showCloseButton:r=!0,...l}=e;return(0,a.jsxs)(E,{"data-slot":"dialog-portal",children:[(0,a.jsx)(F,{}),(0,a.jsxs)(_.VY,{"data-slot":"dialog-content",className:o("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...l,children:[t,r&&(0,a.jsxs)(_.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(A.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function R(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:o("flex flex-col gap-2 text-center sm:text-left",s),...t})}function P(e){let{className:s,...t}=e;return(0,a.jsx)(_.Dx,{"data-slot":"dialog-title",className:o("text-lg leading-none font-semibold",s),...t})}function D(e){let{className:s,...t}=e;return(0,a.jsx)(_.dk,{"data-slot":"dialog-description",className:o("text-muted-foreground text-sm",s),...t})}var I=t(2097),L=t(9397),O=t(8662),V=t(7689),M=t(1101),G=t(292),B=t(4501),H=t(3276),W=t(9227),K=t(1094),q=t(9076),X=t(401);let J=["The quick brown fox jumps over the lazy dog.","Hello, this is a sample of my voice for text-to-speech generation.","I am recording my voice to create a custom voice model.","Technology has revolutionized the way we communicate and interact.","The weather today is absolutely beautiful with clear blue skies."];function Y(e){let{onRecordingComplete:s,className:t}=e,[l,n]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(0),[h,p]=(0,r.useState)(0),[g,f]=(0,r.useState)(null),[j,N]=(0,r.useState)(!1),y=(0,r.useRef)(null),w=(0,r.useRef)([]),b=(0,r.useRef)(null),k=(0,r.useRef)(null);(0,r.useEffect)(()=>()=>{b.current&&clearInterval(b.current),k.current&&(k.current.pause(),k.current=null)},[]);let C=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});w.current=[],s.ondataavailable=e=>{e.data.size>0&&w.current.push(e.data)},s.onstop=()=>{let s=new Blob(w.current,{type:"audio/webm"});f(s),e.getTracks().forEach(e=>e.stop())},s.start(),y.current=s,n(!0),m(0),b.current=setInterval(()=>{m(e=>e+1)},1e3)}catch(e){console.error("Failed to start recording:",e),alert("Failed to access microphone. Please check permissions.")}},S=()=>{f(null),m(0),N(!1),k.current&&(k.current.pause(),k.current=null)};return(0,a.jsxs)(x,{className:o("p-4 space-y-4",t),children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Read this text:"}),(0,a.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>{p(e=>(e+1)%J.length)},className:"h-6 text-xs",children:"Next Sample"})]}),(0,a.jsx)("div",{className:"p-3 bg-muted rounded-lg",children:(0,a.jsx)("p",{className:"text-sm leading-relaxed",children:J[h]})}),(0,a.jsxs)(v,{variant:"secondary",className:"text-xs",children:["Sample ",h+1," of ",J.length]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-mono font-bold",children:"".concat(Math.floor(d/60),":").concat((d%60).toString().padStart(2,"0"))}),l&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-1",children:[(0,a.jsx)("div",{className:o("w-2 h-2 rounded-full bg-red-500",i?"":"animate-pulse")}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:i?"Paused":"Recording"})]})]}),g?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u,{onClick:()=>{if(!g)return;if(j&&k.current){k.current.pause(),N(!1);return}let e=new Audio(URL.createObjectURL(g));k.current=e,e.onended=()=>{N(!1),k.current=null},e.play(),N(!0)},variant:"outline",className:"flex-1 gap-2 bg-transparent",children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.Z,{className:"h-4 w-4"}),"Pause"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.Z,{className:"h-4 w-4"}),"Play"]})}),(0,a.jsxs)(u,{onClick:S,variant:"outline",className:"flex-1 gap-2 bg-transparent",children:[(0,a.jsx)(q.Z,{className:"h-4 w-4"}),"Re-record"]})]}),(0,a.jsxs)(u,{onClick:()=>{g&&(s(g),S())},className:"w-full gap-2",children:[(0,a.jsx)(X.Z,{className:"h-4 w-4"}),"Use This Recording"]})]}):(0,a.jsx)("div",{className:"flex gap-2",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{onClick:()=>{y.current&&l&&(i?(y.current.resume(),b.current=setInterval(()=>{m(e=>e+1)},1e3)):(y.current.pause(),b.current&&clearInterval(b.current)),c(!i))},variant:"outline",className:"flex-1 gap-2 bg-transparent",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.Z,{className:"h-4 w-4"}),"Resume"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.Z,{className:"h-4 w-4"}),"Pause"]})}),(0,a.jsxs)(u,{onClick:()=>{y.current&&l&&(y.current.stop(),n(!1),c(!1),b.current&&(clearInterval(b.current),b.current=null))},variant:"destructive",className:"flex-1 gap-2",children:[(0,a.jsx)(K.Z,{className:"h-4 w-4"}),"Stop"]})]}):(0,a.jsxs)(u,{onClick:C,className:"flex-1 gap-2",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4"}),"Start Recording"]})})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,a.jsx)("p",{children:"\uD83D\uDCA1 Tips for best results:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-0.5 ml-2",children:[(0,a.jsx)("li",{children:"Record in a quiet environment"}),(0,a.jsx)("li",{children:"Speak clearly and naturally"}),(0,a.jsx)("li",{children:"Keep consistent distance from microphone"}),(0,a.jsx)("li",{children:"Record at least 10-15 seconds"})]})]})]})}var $=t(8846);function Q(e){let{className:s,defaultValue:t,value:l,min:n=0,max:i=100,...c}=e,d=r.useMemo(()=>Array.isArray(l)?l:Array.isArray(t)?t:[n,i],[l,t,n,i]);return(0,a.jsxs)($.fC,{"data-slot":"slider",defaultValue:t,value:l,min:n,max:i,className:o("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",s),...c,children:[(0,a.jsx)($.fQ,{"data-slot":"slider-track",className:"bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5",children:(0,a.jsx)($.e6,{"data-slot":"slider-range",className:"bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full"})}),Array.from({length:d.length},(e,s)=>(0,a.jsx)($.bU,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},s))]})}function ee(e){let{audioUrl:s,onTrimComplete:t,onCancel:l,className:n}=e,[i,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(0),[x,h]=(0,r.useState)(0),[p,g]=(0,r.useState)(0),[f,j]=(0,r.useState)(0),[v,N]=(0,r.useState)(!1),y=(0,r.useRef)(null),w=(0,r.useRef)(null),b=(0,r.useRef)(null),k=(0,r.useRef)(null),C=(0,r.useRef)();(0,r.useEffect)(()=>{let e=new Audio(s);y.current=e;let t=()=>{m(e.duration),j(e.duration),S()},a=()=>{h(e.currentTime)},r=()=>{c(!1),h(p)};return e.addEventListener("loadedmetadata",t),e.addEventListener("timeupdate",a),e.addEventListener("ended",r),()=>{e.pause(),e.removeEventListener("loadedmetadata",t),e.removeEventListener("timeupdate",a),e.removeEventListener("ended",r),C.current&&cancelAnimationFrame(C.current)}},[s]),(0,r.useEffect)(()=>{let e=y.current;if(!e)return;let s=()=>{e.currentTime>=f?(e.pause(),c(!1)):C.current=requestAnimationFrame(s)};return i&&(C.current=requestAnimationFrame(s)),()=>{C.current&&cancelAnimationFrame(C.current)}},[i,f]);let S=async()=>{try{let e=await fetch(s),t=await e.arrayBuffer(),a=window.AudioContext||window.webkitAudioContext;if(!a)throw Error("AudioContext not supported in this environment");let r=new a;b.current=r,"suspended"===r.state&&await r.resume();let l=await r.decodeAudioData(t);k.current=l,z(l)}catch(e){console.error("Failed to load audio data:",e),alert("Could not load audio file for trimming. Please try a different file.")}},z=e=>{let s=w.current;if(!s)return;let t=s.getContext("2d");if(!t)return;let a=s.width,r=s.height,l=e.getChannelData(0),n=Math.ceil(l.length/a),i=r/2;t.fillStyle="rgb(242, 242, 242)",t.fillRect(0,0,a,r),t.strokeStyle="rgb(59, 130, 246)",t.lineWidth=1,t.beginPath();for(let e=0;e<a;e++){let s=1,a=-1;for(let t=0;t<n;t++){let r=l[e*n+t];r<s&&(s=r),r>a&&(a=r)}t.moveTo(e,(1+s)*i),t.lineTo(e,(1+a)*i)}t.stroke()},_=async()=>{if(k.current&&b.current){N(!0);try{let e=k.current,s=b.current,a=e.sampleRate,r=Math.floor(p*a),l=Math.floor(f*a),n=s.createBuffer(e.numberOfChannels,l-r,a);for(let s=0;s<e.numberOfChannels;s++){let t=e.getChannelData(s);n.getChannelData(s).set(t.subarray(r,l))}let i=await A(n);t(i)}catch(e){console.error("Failed to trim audio:",e),alert("Failed to trim audio. Please try again.")}finally{N(!1)}}},A=async e=>{let s=e.numberOfChannels,t=e.sampleRate,a=2*s,r=e.length*s*2,l=new ArrayBuffer(44+r),n=new DataView(l),i=(e,s)=>{for(let t=0;t<s.length;t++)n.setUint8(e+t,s.charCodeAt(t))};i(0,"RIFF"),n.setUint32(4,36+r,!0),i(8,"WAVE"),i(12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,s,!0),n.setUint32(24,t,!0),n.setUint32(28,t*a,!0),n.setUint16(32,a,!0),n.setUint16(34,16,!0),i(36,"data"),n.setUint32(40,r,!0);let c=44;for(let t=0;t<s;t++){let s=e.getChannelData(t);for(let e=0;e<s.length;e++){let t=Math.max(-1,Math.min(1,s[e]));n.setInt16(c,t<0?32768*t:32767*t,!0),c+=2}}return new Blob([l],{type:"audio/wav"})},Z=e=>"".concat(Math.floor(e/60),":").concat(Math.floor(e%60).toString().padStart(2,"0"),".").concat(Math.floor(e%1*100).toString().padStart(2,"0")),U=d>0?p/d*100:0,E=d>0?f/d*100:100,F=d>0?x/d*100:0;return(0,a.jsxs)("div",{className:o("p-4 space-y-4",n),children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,a.jsx)(G.Z,{className:"h-4 w-4"}),"Trim Audio"]})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("canvas",{ref:w,width:600,height:100,className:"w-full h-24 bg-muted rounded"}),(0,a.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,a.jsx)("div",{className:"absolute top-0 bottom-0 bg-black/50",style:{left:0,width:"".concat(U,"%")}}),(0,a.jsx)("div",{className:"absolute top-0 bottom-0 bg-black/50",style:{left:"".concat(E,"%"),right:0}}),(0,a.jsx)("div",{className:"absolute top-0 bottom-0 border-l-2 border-primary",style:{left:"".concat(U,"%")}}),(0,a.jsx)("div",{className:"absolute top-0 bottom-0 border-r-2 border-primary",style:{left:"".concat(E,"%")}}),(0,a.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 bg-red-500",style:{left:"".concat(F,"%")}})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Start Time"}),(0,a.jsx)("span",{className:"font-mono",children:Z(p)})]}),(0,a.jsx)(Q,{value:[U],onValueChange:e=>{let s=e[0]/100*d;s>=f||g(s)},max:100,step:.1,className:"w-full","aria-label":"Audio start time"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"End Time"}),(0,a.jsx)("span",{className:"font-mono",children:Z(f)})]}),(0,a.jsx)(Q,{value:[E],onValueChange:e=>{let s=e[0]/100*d;s<=p||j(s)},max:100,step:.1,className:"w-full","aria-label":"Audio end time"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Duration: ",Z(f-p)]}),(0,a.jsxs)("span",{children:["Total: ",Z(d)]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u,{onClick:()=>{let e=y.current;e&&(i?(e.pause(),c(!1)):((e.currentTime<p||e.currentTime>=f)&&(e.currentTime=p),e.play(),c(!0)))},variant:"outline",className:"flex-1 gap-2",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.Z,{className:"h-4 w-4"}),"Pause"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.Z,{className:"h-4 w-4"}),"Preview"]})}),(0,a.jsxs)(u,{onClick:_,disabled:v,className:"flex-1 gap-2",children:[(0,a.jsx)(X.Z,{className:"h-4 w-4"}),v?"Trimming...":"Apply Trim"]})]})]})}function es(e){let{className:s}=e,{addVoice:t}=(0,I.m)(),[l,n]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(""),[h,p]=(0,r.useState)(null),[g,f]=(0,r.useState)([]),[j,y]=(0,r.useState)(!1),[b,_]=(0,r.useState)("upload"),[E,F]=(0,r.useState)(null),[D,H]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(0,B.Vt)().then(e=>H(e)).catch(()=>H(!1))},[D]);let W=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?c(!0):"dragleave"===e.type&&c(!1)},[]),K=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),c(!1);let s=Array.from(e.dataTransfer.files).filter(e=>"audio/mp3"===e.type||"audio/wav"===e.type||"audio/mpeg"===e.type||"audio/webm"===e.type);!(s.length>0)||h||(p(s[0]),d||m(s[0].name.replace(/\.[^/.]+$/,"")))},[h,d]),q=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(D)try{let t=await window.pywebview.api.select_audio_file();if(t&&t.success&&t.file_data){let a=atob(t.file_data),r=Array(a.length);for(let e=0;e<a.length;e++)r[e]=a.charCodeAt(e);let l=new Uint8Array(r),n=new File([l],t.filename,{type:t.mime_type});e&&s>=0?X(s,n):(p(n),d||m(t.filename.replace(/\.[^/.]+$/,"")))}}catch(e){console.error("Error selecting file:",e)}},X=(e,s)=>{f(t=>t.map((t,a)=>a===e?{...t,file:s}:t))},J=(e,s)=>{X(e,new File([s],"emotion-".concat(Date.now(),".webm"),{type:"audio/webm"}))},$=e=>{f(s=>s.filter((s,t)=>t!==e))},Q=(e,s)=>{f(t=>t.map((t,a)=>a===e?{...t,name:s}:t))},es=e=>{let s=g[e];s.file&&F({url:URL.createObjectURL(s.file),type:"emotion",index:e})},et=async()=>{if(d.trim()&&h){y(!0);try{let e=g.filter(e=>e.name.trim()&&e.file).map((e,s)=>({id:"".concat(Date.now(),"-").concat(s),name:e.name.trim(),audioFile:e.file}));t({name:d.trim(),mainAudio:h,emotions:e}),m(""),p(null),f([]),n(!1)}catch(e){console.error("Error uploading voice:",e)}finally{y(!1)}}},ea=()=>{m(""),p(null),f([]),c(!1),_("upload")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(Z,{open:l,onOpenChange:e=>{n(e),e||ea()},children:[(0,a.jsx)(U,{asChild:!0,children:(0,a.jsxs)(u,{className:o("gap-2",s),children:[(0,a.jsx)(L.Z,{className:"h-4 w-4"}),"Upload Voice"]})}),(0,a.jsxs)(T,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(R,{children:(0,a.jsxs)(P,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5"}),"Add New Voice"]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{htmlFor:"voice-name",children:"Voice Name"}),(0,a.jsx)(N,{id:"voice-name",value:d,onChange:e=>m(e.target.value),placeholder:"Enter a name for this voice"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{children:"Main Audio (Neutral)"}),(0,a.jsxs)(k,{value:b,onValueChange:e=>_(e),children:[(0,a.jsxs)(C,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(S,{value:"upload",children:[(0,a.jsx)(V.Z,{className:"h-4 w-4 mr-2"}),"Upload File"]}),(0,a.jsxs)(S,{value:"record",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Record Voice"]})]}),(0,a.jsx)(z,{value:"upload",className:"mt-4",children:(0,a.jsx)("div",{className:o("border-2 border-dashed rounded-lg p-6 text-center transition-colors",i?"border-primary bg-primary/5":"border-border",h?"border-green-500 bg-green-50 dark:bg-green-950/20":""),onDragEnter:W,onDragLeave:W,onDragOver:W,onDrop:K,children:h?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,a.jsx)(M.Z,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium text-green-700 dark:text-green-400",children:h.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(h.size/1024/1024).toFixed(2)," MB"]})]}),(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>p(null),className:"text-muted-foreground hover:text-destructive",children:(0,a.jsx)(A.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)(u,{size:"sm",variant:"outline",onClick:()=>{h&&F({url:URL.createObjectURL(h),type:"main"})},className:"gap-2 bg-transparent",children:[(0,a.jsx)(G.Z,{className:"h-4 w-4"}),"Trim Audio"]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)(V.Z,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:"Drop your audio file here"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Supports MP3, WAV, and WebM files"}),D?(0,a.jsx)(u,{variant:"outline",size:"sm",className:"mt-2 bg-transparent",onClick:()=>q(),children:"Browse Files"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",accept:".mp3,.wav,.webm,audio/mp3,audio/wav,audio/mpeg,audio/webm",onChange:e=>{let s=e.target.files;s&&s[0]&&!h&&(p(s[0]),d||m(s[0].name.replace(/\.[^/.]+$/,"")))},className:"hidden",id:"main-audio-upload"}),(0,a.jsx)(w,{htmlFor:"main-audio-upload",className:"cursor-pointer",children:(0,a.jsx)(u,{variant:"outline",size:"sm",className:"mt-2 bg-transparent",asChild:!0,children:(0,a.jsx)("span",{children:"Browse Files"})})})]})]})})}),(0,a.jsx)(z,{value:"record",className:"mt-4",children:(0,a.jsx)(Y,{onRecordingComplete:e=>{p(new File([e],"recorded-voice-".concat(Date.now(),".webm"),{type:"audio/webm"})),d||m("Voice Recording ".concat(new Date().toLocaleDateString())),_("upload")}})})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w,{children:"Emotion Variations (Optional)"}),(0,a.jsxs)(v,{variant:"secondary",className:"text-xs",children:[g.length,"/5"]})]}),g.map((e,s)=>(0,a.jsxs)(x,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)(N,{placeholder:"Emotion name (e.g., Happy, Sad, Angry)",value:e.name,onChange:e=>Q(s,e.target.value),className:"flex-1"}),(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>$(s),className:"text-muted-foreground hover:text-destructive",children:(0,a.jsx)(A.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)(k,{defaultValue:"upload",children:[(0,a.jsxs)(C,{className:"grid w-full grid-cols-2 mb-3",children:[(0,a.jsx)(S,{value:"upload",children:"Upload"}),(0,a.jsx)(S,{value:"record",children:"Record"})]}),(0,a.jsx)(z,{value:"upload",children:(0,a.jsx)("div",{className:"border border-dashed border-border rounded p-3 text-center",children:e.file?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)("span",{className:"text-sm text-green-700 dark:text-green-400",children:e.file.name}),(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>X(s,null),className:"h-6 w-6 p-0",children:(0,a.jsx)(A.Z,{className:"h-3 w-3"})})]}),(0,a.jsxs)(u,{size:"sm",variant:"outline",onClick:()=>es(s),className:"gap-2",children:[(0,a.jsx)(G.Z,{className:"h-3 w-3"}),"Trim"]})]}):(0,a.jsx)("div",{children:D?(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:()=>q(!0,s),children:(0,a.jsx)("span",{className:"text-xs",children:"Upload Audio"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",accept:".mp3,.wav,.webm,audio/mp3,audio/wav,audio/mpeg,audio/webm",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&X(s,a)},className:"hidden",id:"emotion-upload-".concat(s)}),(0,a.jsx)(w,{htmlFor:"emotion-upload-".concat(s),className:"cursor-pointer",children:(0,a.jsx)(u,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)("span",{className:"text-xs",children:"Upload Audio"})})})]})})})}),(0,a.jsx)(z,{value:"record",children:(0,a.jsx)(Y,{onRecordingComplete:e=>J(s,e)})})]})]},s)),g.length<5&&(0,a.jsxs)(u,{variant:"outline",onClick:()=>{g.length<5&&f(e=>[...e,{name:"",file:null}])},className:"w-full gap-2 bg-transparent",children:[(0,a.jsx)(L.Z,{className:"h-4 w-4"}),"Add Emotion Variation"]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(u,{onClick:()=>n(!1),variant:"outline",className:"flex-1",children:"Cancel"}),(0,a.jsx)(u,{onClick:et,disabled:!d.trim()||!h||j,className:"flex-1",children:j?"Uploading...":"Create Voice"})]})]})]})]}),(0,a.jsx)(Z,{open:!!E,onOpenChange:e=>{e||F(null)},children:(0,a.jsx)(T,{className:"max-w-3xl",children:E&&(0,a.jsx)(ee,{audioUrl:E.url,onTrimComplete:e=>{if(!E)return;let s=new File([e],"trimmed-".concat(Date.now(),".wav"),{type:"audio/wav"});"main"===E.type?p(s):"emotion"===E.type&&void 0!==E.index&&X(E.index,s),F(null)},onCancel:()=>F(null)})})})]})}var et=t(610);function ea(e){let{className:s,value:t,...r}=e;return(0,a.jsx)(et.fC,{"data-slot":"progress",className:o("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...r,children:(0,a.jsx)(et.z$,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}let er=(0,n.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function el(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:o(er({variant:t}),s),...r})}function en(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:o("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...t})}function ei(){var e;let{serverConfig:s,isServerSetupComplete:t,checkServerHealth:l}=(0,I.m)(),[n,i]=(0,r.useState)(!1),[c,o]=(0,r.useState)([]),[d,m]=(0,r.useState)(null),[g,j]=(0,r.useState)(null),N=(0,r.useRef)(0),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!t||!s){y.current&&clearInterval(y.current),y.current=null;return}let e=async()=>{let e=Date.now();await l(),N.current=Date.now()-e};return e(),y.current=setInterval(e,3e4),()=>{y.current&&clearInterval(y.current)}},[t,l]),(0,r.useEffect)(()=>{if(!s||!s.lastChecked)return;let e="online"===s.status,t=null,a={timestamp:new Date(s.lastChecked),status:e,responseTime:N.current,cpu_usage:s.cpu_usage,ram_usage_percent:s.ram_usage_percent,gpu_utilization:s.gpu_utilization,gpu_memory_usage:s.gpu_memory_usage,warmup_complete:s.warmup_complete};e?a.warmup_complete?a.cpu_usage>90?t="High CPU usage detected - performance may be impacted.":a.ram_usage_percent>95?t="High memory usage detected - server may become unstable.":"number"==typeof a.gpu_utilization&&a.gpu_utilization>95&&(t="GPU is at maximum capacity - requests may be queued."):t="Server is warming up - performance may be slower.":e||(t="Server connection failed or is offline."),j(t),m(a),o(e=>[...e.slice(-19),a])},[s]);let w=async()=>{if(!s)return;i(!0);let e=Date.now();try{await l(),N.current=Date.now()-e}catch(e){console.error("[v0] Manual health check failed:",e),j("Manual health check failed.")}finally{i(!1)}},b=()=>{if(!d||!d.status)return 0;let e=100;return d.responseTime>2e3?e-=30:d.responseTime>1e3&&(e-=15),d.cpu_usage>90?e-=25:d.cpu_usage>70&&(e-=10),d.ram_usage_percent>95?e-=25:d.ram_usage_percent>80&&(e-=10),d.gpu_utilization&&d.gpu_utilization>95&&(e-=20),d.warmup_complete||(e-=40),Math.max(0,e)};if(!t||!s)return null;let k=null!==(e=null==d?void 0:d.status)&&void 0!==e?e:"online"===s.status,C=(null==d?void 0:d.warmup_complete)===!1;return(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{className:"pb-3",children:(0,a.jsxs)(p,{className:"text-white flex items-center gap-2 text-sm",children:[(0,a.jsx)(em,{}),"Server Monitor"]})}),(0,a.jsxs)(f,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[k?(0,a.jsx)(eu,{}):(0,a.jsx)(ex,{}),(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"local"===s.type?"Local Server":"Remote Server"}),C&&(0,a.jsx)(v,{variant:"secondary",className:"ml-2 text-xs",children:"WARMING"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v,{className:null===k?"bg-zinc-600":k?"bg-green-600":"bg-red-600",children:k?"ONLINE":"OFFLINE"}),(null==d?void 0:d.status)&&(0,a.jsxs)(v,{variant:"outline",className:"text-xs",children:[d.responseTime,"ms"]})]})]}),(0,a.jsx)("div",{className:"text-xs text-zinc-400 font-mono bg-zinc-800 p-2 rounded truncate",children:s.url}),(null==d?void 0:d.status)&&(0,a.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-zinc-400",children:"Performance Score"}),(0,a.jsxs)("span",{className:"text-white font-bold",children:[b(),"/100"]})]}),(0,a.jsx)(ea,{value:b(),className:"h-2"})]}),d&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(ec,{label:"CPU",value:null==d?void 0:d.cpu_usage,unit:"%"}),(0,a.jsx)(ec,{label:"RAM",value:null==d?void 0:d.ram_usage_percent,unit:"%"}),(null==d?void 0:d.gpu_utilization)!==void 0&&(null==d?void 0:d.gpu_utilization)!==null&&(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)(ec,{label:"GPU Utilization",value:null==d?void 0:d.gpu_utilization,unit:"%"})})]}),c.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,a.jsx)(eo,{label:"Uptime",value:"".concat(0===c.length?0:Math.round(c.filter(e=>e.status).length/c.length*100),"%")}),(0,a.jsx)(eo,{label:"Avg Response",value:"".concat((()=>{let e=c.filter(e=>e.status&&e.responseTime>0);return 0===e.length?0:Math.round(e.reduce((e,s)=>e+s.responseTime,0)/e.length)})(),"ms")}),(0,a.jsx)(eo,{label:"Checks",value:c.length})]}),c.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-zinc-400 mb-2",children:"Health Timeline (Last 20 checks)"}),(0,a.jsx)("div",{className:"flex gap-1",children:c.map((e,s)=>{let t=(null==e?void 0:e.warmup_complete)===!1,r=e.status?t?"bg-yellow-600":"bg-green-600":"bg-red-600";return(0,a.jsx)("div",{className:"h-3 flex-1 rounded-sm ".concat(r),title:"".concat(e.timestamp.toLocaleTimeString(),": ").concat(e.status?t?"Online (Warming)":"Online":"Offline"," - ").concat(e.responseTime,"ms")},s)})})]}),g&&(0,a.jsx)(el,{className:"border-yellow-800 bg-yellow-900/20",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(eh,{className:"h-4 w-4 text-yellow-400 mt-0.5"}),(0,a.jsx)(en,{className:"text-yellow-400 ml-2",children:g})]})}),d&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-zinc-400",children:[(0,a.jsx)(ep,{className:"h-3 w-3"}),"Last checked: ",d.timestamp.toLocaleTimeString()]}),(0,a.jsx)(u,{onClick:w,disabled:n,variant:"outline",size:"sm",className:"w-full border-zinc-700 text-zinc-300 hover:bg-zinc-800 bg-transparent",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ef,{className:"h-3 w-3 mr-2 animate-spin"}),"Checking..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eg,{className:"h-3 w-3 mr-2"}),"Manual Health Check"]})})]})]})}let ec=e=>{let{label:s,value:t,unit:r}=e;return(0,a.jsxs)("div",{className:"bg-zinc-800 p-2 rounded text-center",children:[(0,a.jsx)("div",{className:"text-xs text-zinc-400 mb-1",children:s}),(0,a.jsxs)("div",{className:"text-sm font-bold text-white",children:[t.toFixed(0),r]}),(0,a.jsx)(ea,{value:t,className:"h-1 mt-1"})]})},eo=e=>{let{label:s,value:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:t}),(0,a.jsx)("div",{className:"text-xs text-zinc-400",children:s})]})},ed={className:"h-5 w-5 text-zinc-400",strokeWidth:"1.5"},em=()=>(0,a.jsxs)("svg",{...ed,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,a.jsx)("rect",{x:"2",y:"2",width:"20",height:"8",rx:"2",ry:"2"}),(0,a.jsx)("rect",{x:"2",y:"14",width:"20",height:"8",rx:"2",ry:"2"}),(0,a.jsx)("line",{x1:"6",y1:"6",x2:"6.01",y2:"6"}),(0,a.jsx)("line",{x1:"6",y1:"18",x2:"6.01",y2:"18"})]}),eu=()=>(0,a.jsxs)("svg",{className:"h-5 w-5 text-green-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,a.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]}),ex=()=>(0,a.jsxs)("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),(0,a.jsx)("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),(0,a.jsx)("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),(0,a.jsx)("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),(0,a.jsx)("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),(0,a.jsx)("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),(0,a.jsx)("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),eh=e=>(0,a.jsxs)("svg",{...e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),(0,a.jsx)("path",{d:"M12 9v4"}),(0,a.jsx)("path",{d:"m12 17 .01 0"})]}),ep=e=>(0,a.jsxs)("svg",{...e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),eg=e=>(0,a.jsx)("svg",{...e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})}),ef=e=>(0,a.jsx)("svg",{...e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("path",{d:"M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9"})});var ej=t(1671),ev=t(5395),eN=t(7168),ey=t(6865),ew=t(6137),eb=t(4401),ek=t(476),eC=t(5954),eS=t(525),ez=t(6899),e_=t(4822),eA=t(4428),eZ=t(1239),eU=t(91),eE=t(1723),eF=t(6215);function eT(){var e,s;let{serverConfig:t,checkServerHealth:l,isServerSetupComplete:n}=(0,I.m)(),[i,c]=(0,r.useState)([]),[o,d]=(0,r.useState)(null),[m,j]=(0,r.useState)(null),[N,y]=(0,r.useState)(!1),[w,b]=(0,r.useState)(null),[_,A]=(0,r.useState)({requestsPerMinute:0,averageLatency:0,errorRate:0}),Z=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!n||!t){Z.current&&clearInterval(Z.current);return}let e=async()=>{try{var e,s;y(!0);let a=Date.now(),r=await l(),n=Date.now()-a,i=null,o=null;if(r)try{let e=await fetch("".concat(t.url,"/system"));e.ok&&(i=await e.json());let s=await fetch("".concat(t.url,"/metrics"));s.ok&&(o=await s.json())}catch(e){console.warn("[v0] Failed to fetch detailed metrics:",e)}let m={timestamp:new Date,responseTime:n,isOnline:r,cpuUsage:(null==i?void 0:i.cpu_usage)||0,memoryUsage:i?i.ram_used/i.ram_total*100:0,gpuUsage:(null==i?void 0:i.gpu_utilization)||0,gpuMemoryUsed:(null==i?void 0:i.gpu_memory_used)||0,gpuMemoryTotal:(null==i?void 0:i.gpu_memory_total)||0,gpuTemperature:(null==i?void 0:i.gpu_temperature)||null,inferenceTime:(null==o?void 0:null===(e=o.performance_stats)||void 0===e?void 0:e.average_inference_time)||0,queueTime:(null==o?void 0:null===(s=o.performance_stats)||void 0===s?void 0:s.average_preprocessing_time)||0,totalLatency:n,requestsPerSecond:0,warmupComplete:(null==i?void 0:i.warmup_complete)||!1};if(d(m),j(i),b(new Date),null==o?void 0:o.performance_stats){let e=o.performance_stats;A({requestsPerMinute:e.total_requests||0,averageLatency:e.average_inference_time||0,errorRate:0})}c(e=>[...e.slice(-99),m]),console.log("[v0]  health check completed:",m)}catch(s){console.error("[v0]  health check failed:",s);let e={timestamp:new Date,responseTime:0,isOnline:!1};d(e),c(s=>[...s.slice(-99),e])}finally{y(!1)}};return Z.current||(e(),Z.current=setInterval(e,3e4)),()=>{Z.current&&clearInterval(Z.current),Z.current=null}},[n,null==t?void 0:t.url,l]);let U=()=>0===i.length?0:Math.round(i.filter(e=>e.isOnline).length/i.length*100),E=()=>{let e=i.filter(e=>e.isOnline&&e.inferenceTime&&e.inferenceTime>0);return 0===e.length?0:(e.reduce((e,s)=>e+(s.inferenceTime||0),0)/e.length*1e3).toFixed(1)},F=()=>{if(!o||!o.isOnline)return 0;let e=100;return o.responseTime>1e3?e-=20:o.responseTime>500&&(e-=10),o.cpuUsage&&o.cpuUsage>80&&(e-=15),o.memoryUsage&&o.memoryUsage>90&&(e-=15),o.gpuUsage&&o.gpuUsage>95&&(e-=20),o.warmupComplete||(e-=30),Math.max(0,e)},T=e=>e?"".concat((e/1024).toFixed(1)," GB"):"0 GB";return n&&t?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(x,{className:"bg-zinc-900 border-zinc-800",children:(0,a.jsx)(f,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-zinc-400 text-sm",children:"Server Status"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(e=>{switch(e){case"online":return(0,a.jsx)(ej.Z,{className:"h-4 w-4 text-green-400"});case"offline":return(0,a.jsx)(ev.Z,{className:"h-4 w-4 text-red-400"});case"checking":return(0,a.jsx)(eN.Z,{className:"h-4 w-4 text-blue-400 animate-spin"});default:return(0,a.jsx)(ey.Z,{className:"h-4 w-4 text-yellow-400"})}})(t.status),(0,a.jsx)("span",{className:"font-medium ".concat((e=>{switch(e){case"online":return"text-green-400";case"offline":return"text-red-400";case"checking":return"text-blue-400";default:return"text-yellow-400"}})(t.status)),children:t.status.toUpperCase()})]}),(null==o?void 0:o.warmupComplete)===!1&&(0,a.jsx)(v,{variant:"secondary",className:"mt-1 text-xs",children:"WARMING UP"})]}),(0,a.jsx)(eb.Z,{className:"h-8 w-8 text-zinc-600"})]})})}),(0,a.jsx)(x,{className:"bg-zinc-900 border-zinc-800",children:(0,a.jsx)(f,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-zinc-400 text-sm",children:"Performance Score"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-white",children:F()}),(0,a.jsx)("span",{className:"text-sm text-zinc-400",children:"/100"})]})]}),(0,a.jsx)(ek.Z,{className:"h-8 w-8 text-zinc-600"})]})})}),(0,a.jsx)(x,{className:"bg-zinc-900 border-zinc-800",children:(0,a.jsx)(f,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-zinc-400 text-sm",children:"Avg Inference"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-white",children:[E(),"ms"]}),(0,a.jsx)("p",{className:"text-xs text-zinc-500",children:"Last 10 requests"})]}),(0,a.jsx)(eC.Z,{className:"h-8 w-8 text-zinc-600"})]})})}),(0,a.jsx)(x,{className:"bg-zinc-900 border-zinc-800",children:(0,a.jsx)(f,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-zinc-400 text-sm",children:"Uptime"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-white",children:[U(),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-zinc-500",children:[i.length," checks"]})]}),(0,a.jsx)(eS.Z,{className:"h-8 w-8 text-zinc-600"})]})})})]}),(0,a.jsxs)(k,{defaultValue:"overview",className:"w-full",children:[(0,a.jsxs)(C,{className:"grid w-full grid-cols-4 bg-zinc-800",children:[(0,a.jsx)(S,{value:"overview",className:"text-zinc-300",children:"Overview"}),(0,a.jsx)(S,{value:"performance",className:"text-zinc-300",children:"Performance"}),(0,a.jsx)(S,{value:"resources",className:"text-zinc-300",children:"Resources"}),(0,a.jsx)(S,{value:"history",className:"text-zinc-300",children:"History"})]}),(0,a.jsx)(z,{value:"overview",className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{className:"text-white flex items-center gap-2",children:[(0,a.jsx)(ew.Z,{className:"h-4 w-4"}),"Server Information"]})}),(0,a.jsxs)(f,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:"Type:"}),(0,a.jsx)(v,{variant:"outline",children:"local"===t.type?"Local Server":"runpod"===t.type?"RunPod Instance":"Remote Server"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:"URL:"}),(0,a.jsx)("span",{className:"text-white font-mono text-sm truncate max-w-48",children:t.url})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:"Last Check:"}),(0,a.jsx)("span",{className:"text-white text-sm",children:w?w.toLocaleTimeString():"Never"})]}),(null==m?void 0:m.gpu_name)&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:"GPU:"}),(0,a.jsx)("span",{className:"text-white text-sm",children:m.gpu_name})]})]})]}),o&&o.isOnline&&(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{className:"text-white flex items-center gap-2",children:[(0,a.jsx)(eb.Z,{className:"h-4 w-4"}),"Real-time Metrics"]})}),(0,a.jsxs)(f,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-white",children:[o.responseTime,"ms"]}),(0,a.jsx)("p",{className:"text-xs text-zinc-400",children:"Response Time"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-white",children:[o.inferenceTime?(1e3*o.inferenceTime).toFixed(0):"N/A","ms"]}),(0,a.jsx)("p",{className:"text-xs text-zinc-400",children:"Inference Time"})]})]}),o.gpuTemperature&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ez.Z,{className:"h-4 w-4 text-zinc-400"}),(0,a.jsxs)("span",{className:"text-white",children:[o.gpuTemperature,"\xb0C"]}),(0,a.jsx)("span",{className:"text-zinc-400 text-sm",children:"GPU Temp"})]}),!o.warmupComplete&&(0,a.jsxs)(el,{className:"border-yellow-800",children:[(0,a.jsx)(ey.Z,{className:"h-4 w-4"}),(0,a.jsx)(en,{className:"text-yellow-400",children:"Server is still warming up. Performance may be slower than usual."})]})]})]})]})}),(0,a.jsx)(z,{value:"performance",className:"space-y-4",children:(null==m?void 0:m.performance_stats)&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{className:"text-white text-sm",children:"Request Statistics"})}),(0,a.jsxs)(f,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-zinc-400 text-sm",children:"Total Requests:"}),(0,a.jsx)("span",{className:"text-white font-bold",children:m.performance_stats.total_requests})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-zinc-400 text-sm",children:"Cache Hit Rate:"}),(0,a.jsxs)("span",{className:"text-white font-bold",children:[m.performance_stats.cache_hits+m.performance_stats.cache_misses>0?Math.round(m.performance_stats.cache_hits/(m.performance_stats.cache_hits+m.performance_stats.cache_misses)*100):0,"%"]})]})]})]}),(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{className:"text-white text-sm",children:"Processing Times"})}),(0,a.jsxs)(f,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:"Inference:"}),(0,a.jsxs)("span",{className:"text-white",children:[(1e3*m.performance_stats.average_inference_time).toFixed(1),"ms"]})]}),(0,a.jsx)(ea,{value:Math.min(100*m.performance_stats.average_inference_time,100),className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:"Preprocessing:"}),(0,a.jsxs)("span",{className:"text-white",children:[(1e3*m.performance_stats.average_preprocessing_time).toFixed(1),"ms"]})]}),(0,a.jsx)(ea,{value:Math.min(100*m.performance_stats.average_preprocessing_time,100),className:"h-2"})]})]})]}),(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsx)(p,{className:"text-white text-sm",children:"Memory Usage"})}),(0,a.jsxs)(f,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-white",children:T(m.performance_stats.peak_memory_usage)}),(0,a.jsx)("div",{className:"text-xs text-zinc-400",children:"Peak GPU Memory"})]}),m.gpu_memory_total&&(0,a.jsx)(ea,{value:m.performance_stats.peak_memory_usage/1024/m.gpu_memory_total*100,className:"h-3"})]})]})]})}),(0,a.jsxs)(z,{value:"resources",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{className:"text-white flex items-center gap-2 text-sm",children:[(0,a.jsx)(e_.Z,{className:"h-4 w-4"}),"CPU Usage"]})}),(0,a.jsx)(f,{children:(null==o?void 0:o.cpuUsage)?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-white mb-2",children:[o.cpuUsage.toFixed(1),"%"]}),(0,a.jsx)(ea,{value:o.cpuUsage,className:"h-3 mb-2"}),(null==m?void 0:m.cpu_count)&&(0,a.jsxs)("div",{className:"text-xs text-zinc-400",children:[m.cpu_count," cores"]})]}):(0,a.jsx)("div",{className:"text-center text-zinc-400",children:"No data"})})]}),(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{className:"text-white flex items-center gap-2 text-sm",children:[(0,a.jsx)(eA.Z,{className:"h-4 w-4"}),"RAM Usage"]})}),(0,a.jsx)(f,{children:m&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-white mb-2",children:[(m.ram_used/m.ram_total*100).toFixed(1),"%"]}),(0,a.jsx)(ea,{value:m.ram_used/m.ram_total*100,className:"h-3 mb-2"}),(0,a.jsxs)("div",{className:"text-xs text-zinc-400",children:[T(1024*m.ram_used)," /"," ",T(1024*m.ram_total)]})]})})]}),(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{className:"text-white flex items-center gap-2 text-sm",children:[(0,a.jsx)(eZ.Z,{className:"h-4 w-4"}),"GPU Usage"]})}),(0,a.jsx)(f,{children:(null==o?void 0:o.gpuUsage)?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-white mb-2",children:[o.gpuUsage.toFixed(1),"%"]}),(0,a.jsx)(ea,{value:o.gpuUsage,className:"h-3 mb-2"}),(0,a.jsxs)("div",{className:"text-xs text-zinc-400",children:["VRAM: ",T(o.gpuMemoryUsed)," /"," ",T(o.gpuMemoryTotal)]})]}):(0,a.jsx)("div",{className:"text-center text-zinc-400",children:(null==m?void 0:m.gpu_available)?"No data":"No GPU"})})]})]}),(null==m?void 0:m.gpu_available)&&(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsx)(h,{children:(0,a.jsxs)(p,{className:"text-white flex items-center gap-2",children:[(0,a.jsx)(eU.Z,{className:"h-4 w-4"}),"GPU Memory Breakdown"]})}),(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:T(m.gpu_memory_total)}),(0,a.jsx)("div",{className:"text-sm text-zinc-400",children:"Total VRAM"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:T(m.gpu_memory_used)}),(0,a.jsx)("div",{className:"text-sm text-zinc-400",children:"Used VRAM"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:T(m.gpu_memory_available)}),(0,a.jsx)("div",{className:"text-sm text-zinc-400",children:"Available VRAM"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:"VRAM Utilization"}),(0,a.jsxs)("span",{className:"text-white",children:[m.gpu_memory_total?((null!==(e=m.gpu_memory_used)&&void 0!==e?e:0)/m.gpu_memory_total*100).toFixed(1):0,"%"]})]}),(0,a.jsx)(ea,{value:m.gpu_memory_total?(null!==(s=m.gpu_memory_used)&&void 0!==s?s:0/m.gpu_memory_total)*100:0,className:"h-4"})]})]})})]})]}),(0,a.jsx)(z,{value:"history",className:"space-y-4",children:(0,a.jsxs)(x,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsxs)(h,{children:[(0,a.jsxs)(p,{className:"text-white flex items-center gap-2",children:[(0,a.jsx)(eE.Z,{className:"h-4 w-4"}),"Performance History"]}),(0,a.jsxs)(g,{className:"text-zinc-400",children:["Last ",i.length," health checks with detailed metrics"]})]}),(0,a.jsx)(f,{children:i.length>0?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm text-zinc-400",children:"Status Timeline (Last 50 checks)"}),(0,a.jsx)("div",{className:"flex gap-1",children:i.slice(-50).map((e,s)=>{let t=e.isOnline?e.warmupComplete?"opacity-100":"opacity-70":"opacity-100";return(0,a.jsx)("div",{className:"h-4 flex-1 rounded-sm ".concat(e.isOnline?e.warmupComplete?"bg-green-600":"bg-yellow-600":"bg-red-600"," ").concat(t),title:"".concat(e.timestamp.toLocaleTimeString(),": ").concat(e.isOnline?e.warmupComplete?"Online (Ready)":"Online (Warming)":"Offline"," - ").concat(e.responseTime,"ms").concat(e.inferenceTime?" | Inf: ".concat((1e3*e.inferenceTime).toFixed(0),"ms"):"")},s)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-zinc-400 mb-1",children:"Avg Response Time"}),(0,a.jsxs)("div",{className:"text-xl font-bold text-white",children:[(()=>{let e=i.filter(e=>e.isOnline&&e.responseTime>0);return 0===e.length?0:Math.round(e.reduce((e,s)=>e+s.responseTime,0)/e.length)})(),"ms"]}),(0,a.jsx)("div",{className:"text-xs text-zinc-500",children:"Network latency"})]}),(0,a.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-zinc-400 mb-1",children:"Avg Inference Time"}),(0,a.jsxs)("div",{className:"text-xl font-bold text-white",children:[E(),"ms"]}),(0,a.jsx)("div",{className:"text-xs text-zinc-500",children:"Model processing"})]}),(0,a.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-zinc-400 mb-1",children:"Reliability"}),(0,a.jsxs)("div",{className:"text-xl font-bold text-white",children:[U(),"%"]}),(0,a.jsx)("div",{className:"text-xs text-zinc-500",children:"Uptime ratio"})]})]}),(0,a.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(0,a.jsx)("div",{className:"text-sm text-zinc-400 mb-2",children:"Recent Health Checks"}),i.slice(-15).reverse().map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-zinc-800 rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.isOnline?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(ej.Z,{className:"h-3 w-3 text-green-400"}),!e.warmupComplete&&(0,a.jsx)(v,{variant:"secondary",className:"text-xs px-1 py-0",children:"WARM"})]}):(0,a.jsx)(ev.Z,{className:"h-3 w-3 text-red-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-white text-sm",children:e.timestamp.toLocaleTimeString()}),e.gpuTemperature&&(0,a.jsxs)("div",{className:"text-xs text-zinc-400 flex items-center gap-1",children:[(0,a.jsx)(ez.Z,{className:"h-3 w-3"}),e.gpuTemperature,"\xb0C"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-zinc-400",children:[(0,a.jsxs)("span",{children:[e.responseTime,"ms"]}),e.inferenceTime&&(0,a.jsxs)("span",{children:["Inf: ",(1e3*e.inferenceTime).toFixed(0),"ms"]}),e.cpuUsage&&(0,a.jsxs)("span",{children:["CPU: ",e.cpuUsage.toFixed(1),"%"]}),e.gpuUsage&&(0,a.jsxs)("span",{children:["GPU: ",e.gpuUsage.toFixed(1),"%"]})]})]},s))]})]}):(0,a.jsx)("div",{className:"text-center text-zinc-400 py-8",children:"No health data available yet"})})]})})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsx)(u,{onClick:async()=>{y(!0);try{await l()}finally{y(!1)}},disabled:N,variant:"outline",className:"border-zinc-700 text-zinc-300 hover:bg-zinc-800",children:N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eN.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Checking..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eN.Z,{className:"h-4 w-4 mr-2"}),"Manual Health Check"]})}),t.url&&(0,a.jsxs)(u,{onClick:()=>window.open("".concat(t.url,"/metrics"),"_blank"),variant:"outline",className:"border-zinc-700 text-zinc-300 hover:bg-zinc-800",children:[(0,a.jsx)(eF.Z,{className:"h-4 w-4 mr-2"}),"View Raw Metrics"]})]}),o&&o.isOnline&&70>F()&&(0,a.jsxs)(el,{className:"border-yellow-800",children:[(0,a.jsx)(ey.Z,{className:"h-4 w-4"}),(0,a.jsxs)(en,{className:"text-yellow-400",children:[(0,a.jsx)("strong",{children:"Performance Warning:"})," Server performance is below optimal levels.",!o.warmupComplete&&" Server is still warming up.",o.responseTime>1e3&&" High response times detected.",o.cpuUsage&&o.cpuUsage>80&&" High CPU usage detected."]})]})]}):(0,a.jsx)(x,{className:"bg-zinc-900 border-zinc-800",children:(0,a.jsxs)(f,{className:"p-6 text-center",children:[(0,a.jsx)(ew.Z,{className:"h-12 w-12 text-zinc-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-zinc-400",children:"No server configured"}),(0,a.jsx)("p",{className:"text-zinc-500 text-sm",children:"Complete server setup to view health dashboard"})]})})}var eR=t(407),eP=t(2451),eD=t(8930);function eI(){let{voices:e,selectedVoiceId:s,selectedEmotionId:t,setSelectedVoice:l,setSelectedEmotion:n,deleteVoice:i,updateVoice:c,addEmotionToVoice:d,removeEmotionFromVoice:m,hasVoiceAudio:h,getVoiceSampleBlob:p}=(0,I.m)(),[g,f]=(0,r.useState)(null),[j,y]=(0,r.useState)(!1),[b,k]=(0,r.useState)("voices"),[C,S]=(0,r.useState)(!1),[z,_]=(0,r.useState)(null),[U,E]=(0,r.useState)(""),[F,R]=(0,r.useState)(null),P=(0,r.useRef)(null),[D,M]=(0,r.useState)(null),[B,K]=(0,r.useState)(null),[q,X]=(0,r.useState)(null),J=(0,r.useRef)(new Map),Y=(0,r.useRef)(new Map);(0,r.useEffect)(()=>()=>{J.current.forEach(e=>{e.pause()}),J.current.clear(),Y.current.forEach(e=>URL.revokeObjectURL(e)),Y.current.clear()},[]),(0,r.useEffect)(()=>{(async()=>{if(!s){M(null);return}let t=e.find(e=>e.id===s);if(!t){M(null);return}try{let e=await h(s),a=await Promise.all(t.emotions.map(async e=>[e.id,await h(s,e.id)])),r=Object.fromEntries(a);M({main:e,emotions:r})}catch(e){console.error("Failed to fetch audio availability:",e),M(null)}})()},[s,e,h]);let $=e=>{s===e?l(null):l(e),n(null),_(null)},Q=e=>{t===e?n(null):n(e)},et=async(e,s)=>{let t=s||"".concat(e,"-main");if(g&&J.current.has(g)){let e=J.current.get(g);null==e||e.pause();let s=Y.current.get(g);if(s&&(URL.revokeObjectURL(s),Y.current.delete(g)),g===t){f(null);return}}try{let a=await p(e,s);if(!a||0===a.size){console.warn("No audio available for playback"),f(null);return}let r=new Blob([a],{type:"audio/wav"}),l=URL.createObjectURL(r);Y.current.set(t,l);let n=J.current.get(t);if(!n||n.src!==l){if(n){let e=Y.current.get(t);e&&e!==l&&URL.revokeObjectURL(e)}(n=new Audio).preload="auto",J.current.set(t,n),n.onended=()=>{f(null);let e=Y.current.get(t);e&&(URL.revokeObjectURL(e),Y.current.delete(t))},n.onerror=e=>{f(null),console.error("Failed to play audio:",e);let s=Y.current.get(t);s&&(URL.revokeObjectURL(s),Y.current.delete(t))},n.src=l,n.load()}f(t),await new Promise(e=>setTimeout(e,100)),await n.play()}catch(e){console.error("Failed to prepare audio for playback:",e),f(null)}},ea=async(e,s)=>{try{let t=await p(e,s);if(!t||0===t.size){console.warn("No audio available for trimming");return}let a=URL.createObjectURL(t);q&&URL.revokeObjectURL(q),X(a),K({voiceId:e,emotionId:s,url:a})}catch(e){console.error("Failed to prepare audio for trimming:",e)}},er=async t=>{if(!B)return;let a=new File([t],"trimmed-".concat(Date.now(),".wav"),{type:"audio/wav"}),r=e.find(e=>e.id===B.voiceId);if(r){if(B.emotionId){let e=r.emotions.map(e=>e.id===B.emotionId?{...e,audioFile:a}:e);await c(B.voiceId,{emotions:e})}else await c(B.voiceId,{mainAudio:a});q&&(URL.revokeObjectURL(q),X(null)),K(null),s===B.voiceId&&M(null)}},el=e=>{_(e),E(""),R(null)},en=()=>{_(null),E(""),R(null)},ec=async e=>{var s,t,a;if(null===(t=window.pywebview)||void 0===t?void 0:null===(s=t.api)||void 0===s?void 0:s.select_audio_file)try{let e=await window.pywebview.api.select_audio_file();if(e.success&&e.file_data){let s=atob(e.file_data),t=Array(s.length);for(let e=0;e<s.length;e++)t[e]=s.charCodeAt(e);let a=new Uint8Array(t),r=new Blob([a],{type:e.mime_type}),l=new File([r],e.filename,{type:e.mime_type});R(l)}else e.error&&console.error("File selection failed:",e.error)}catch(e){console.error("Failed to select file via pywebview:",e)}else{let s=null==e?void 0:null===(a=e.target.files)||void 0===a?void 0:a[0];s&&s.type.startsWith("audio/")&&R(s)}},eo=async()=>{if(z&&U.trim())try{await d(z,{name:U.trim(),audioFile:F}),en()}catch(e){console.error("Failed to add emotion:",e)}},ed=async(e,s)=>{try{await m(e,s)}catch(e){console.error("Failed to delete emotion:",e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-sidebar border-r border-sidebar-border flex flex-col h-full transition-all duration-300 ease-in-out ".concat(C?"w-12":"w-80"),children:[(0,a.jsxs)("div",{className:"flex-shrink-0 relative transition-all duration-300 ".concat(C?"p-2 pt-4":"p-6 pb-0"),children:[(0,a.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>{S(!C)},className:"absolute top-4 right-2 h-8 w-8 p-0 text-muted-foreground hover:text-foreground z-10",children:C?(0,a.jsx)(eR.Z,{className:"h-4 w-4"}):(0,a.jsx)(eP.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex border-b border-zinc-700 transition-opacity duration-300 ".concat(C?"opacity-0 pointer-events-none":"opacity-100"),children:[(0,a.jsx)("button",{onClick:()=>k("voices"),className:"flex-1 pb-2 text-sm font-medium transition-colors ".concat("voices"===b?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:"Manage Voices"}),(0,a.jsx)("button",{onClick:()=>k("server"),className:"flex-1 pb-2 text-sm font-medium transition-colors ".concat("server"===b?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:"Server"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto transition-all duration-300 ".concat(C?"hidden":"p-6"),children:["server"===b&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ei,{}),(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"w-full border-zinc-700 text-zinc-300 hover:bg-zinc-800 bg-transparent",onClick:()=>y(!0),children:[(0,a.jsx)(eF.Z,{className:"h-3 w-3 mr-2"}),"View Full Dashboard"]})]})}),"voices"===b&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-sm font-medium text-sidebar-foreground",children:"Voices"}),(0,a.jsx)(es,{})]}),0===e.length?(0,a.jsxs)(x,{className:"p-4 text-center",children:[(0,a.jsx)(O.Z,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No voices uploaded yet"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Upload or record your first voice sample to get started"})]}):(0,a.jsx)("div",{className:"space-y-3",children:e.map(e=>{let r=s===e.id,l=z===e.id;return(0,a.jsxs)(x,{className:o("p-3 transition-all",r&&"ring-2 ring-primary"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("button",{onClick:()=>$(e.id),className:o("text-sm font-medium text-left flex-1",r?"text-primary":"text-foreground"),children:e.name}),(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>i(e.id),className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive",children:(0,a.jsx)(eD.Z,{className:"h-3 w-3"})})]}),r&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>Q("neutral"),className:o("flex-1 text-left px-2 py-1 rounded text-xs transition-colors","neutral"===t||!t&&r?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-accent"),children:"Neutral (Main)"}),(null==D?void 0:D.main)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>et(e.id),className:"h-6 w-6 p-0",children:g==="".concat(e.id,"-main")?(0,a.jsx)(W.Z,{className:"h-3 w-3"}):(0,a.jsx)(H.Z,{className:"h-3 w-3"})}),(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>ea(e.id),className:"h-6 w-6 p-0",title:"Trim audio",children:(0,a.jsx)(G.Z,{className:"h-3 w-3"})})]})]}),e.emotions.map(s=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>Q(s.id),className:o("flex-1 text-left px-2 py-1 rounded text-xs transition-colors",t===s.id?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-accent"),children:s.name}),(null==D?void 0:D.emotions[s.id])&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>et(e.id,s.id),className:"h-6 w-6 p-0",children:g===s.id?(0,a.jsx)(W.Z,{className:"h-3 w-3"}):(0,a.jsx)(H.Z,{className:"h-3 w-3"})}),(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>ea(e.id,s.id),className:"h-6 w-6 p-0",title:"Trim audio",children:(0,a.jsx)(G.Z,{className:"h-3 w-3"})})]}),(0,a.jsx)(u,{size:"sm",variant:"ghost",onClick:()=>ed(e.id,s.id),className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive",title:"Delete emotion",children:(0,a.jsx)(A.Z,{className:"h-3 w-3"})})]},s.id)),l?(0,a.jsxs)("div",{className:"space-y-2 p-2 bg-muted/50 rounded border border-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w,{htmlFor:"emotion-name",className:"text-xs",children:"Emotion Name"}),(0,a.jsx)(N,{id:"emotion-name",value:U,onChange:e=>E(e.target.value),placeholder:"e.g., Happy, Angry, Whisper",className:"h-7 text-xs",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&U.trim()?eo():"Escape"===e.key&&en()}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w,{className:"text-xs",children:"Audio Sample (Optional)"}),(0,a.jsx)("input",{ref:P,type:"file",accept:"audio/*",onChange:ec,className:"hidden"}),(0,a.jsxs)(u,{variant:"outline",size:"sm",onClick:()=>{var e,s,t;(null===(s=window.pywebview)||void 0===s?void 0:null===(e=s.api)||void 0===e?void 0:e.select_audio_file)?ec():null===(t=P.current)||void 0===t||t.click()},className:"w-full h-7 text-xs",children:[(0,a.jsx)(V.Z,{className:"h-3 w-3 mr-2"}),F?F.name:"Upload Audio"]}),F&&(0,a.jsxs)(u,{variant:"ghost",size:"sm",onClick:()=>R(null),className:"w-full h-6 text-xs mt-1 text-muted-foreground hover:text-foreground",children:[(0,a.jsx)(A.Z,{className:"h-3 w-3 mr-1"}),"Clear file"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:en,className:"flex-1 h-7 text-xs",children:"Cancel"}),(0,a.jsx)(u,{size:"sm",onClick:eo,disabled:!U.trim(),className:"flex-1 h-7 text-xs",children:"Add Emotion"})]})]}):(0,a.jsxs)(u,{variant:"outline",size:"sm",onClick:()=>el(e.id),className:"w-full h-7 text-xs",children:[(0,a.jsx)(L.Z,{className:"h-3 w-3 mr-2"}),"Add Emotion"]})]}),(0,a.jsx)("div",{className:"flex gap-1 mt-2",children:(0,a.jsxs)(v,{variant:"secondary",className:"text-xs",children:[e.emotions.length+1," variants"]})})]},e.id)})})]})]}),j&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Server Health Dashboard"}),(0,a.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>y(!1),className:"text-zinc-400 hover:text-white",children:""})]}),(0,a.jsx)(eT,{})]})})})]}),(0,a.jsx)(Z,{open:!!B,onOpenChange:e=>{e||(q&&(URL.revokeObjectURL(q),X(null)),K(null))},children:(0,a.jsx)(T,{className:"max-w-3xl",children:B&&(0,a.jsx)(ee,{audioUrl:B.url,onTrimComplete:er,onCancel:()=>{q&&(URL.revokeObjectURL(q),X(null)),K(null)}})})})]})}var eL=t(2926);function eO(){let{serverConfig:e,isServerSetupComplete:s}=(0,I.m)();return s&&e?(0,a.jsxs)(v,{className:(()=>{switch(e.status){case"online":return"bg-green-600 hover:bg-green-700";case"offline":return"bg-red-600 hover:bg-red-700";case"checking":return"bg-blue-600 hover:bg-blue-700";default:return"bg-yellow-600 hover:bg-yellow-700"}})(),children:[(()=>{switch(e.status){case"online":return(0,a.jsx)(eL.Z,{className:"h-3 w-3 mr-1 text-green-400"});case"offline":return(0,a.jsx)(ev.Z,{className:"h-3 w-3 mr-1 text-red-400"});case"checking":return(0,a.jsx)(eN.Z,{className:"h-3 w-3 mr-1 text-blue-400 animate-spin"});default:return(0,a.jsx)(ey.Z,{className:"h-3 w-3 mr-1 text-yellow-400"})}})(),e.status.charAt(0).toUpperCase()+e.status.slice(1)]}):(0,a.jsxs)(v,{variant:"secondary",className:"bg-zinc-800 text-zinc-400",children:[(0,a.jsx)(ey.Z,{className:"h-3 w-3 mr-1"}),"No Server"]})}var eV=t(6873),eM=t(875),eG=t(2135);function eB(e){let{...s}=e;return(0,a.jsx)(eV.fC,{"data-slot":"select",...s})}function eH(e){let{...s}=e;return(0,a.jsx)(eV.B4,{"data-slot":"select-value",...s})}function eW(e){let{className:s,size:t="default",children:r,...l}=e;return(0,a.jsxs)(eV.xz,{"data-slot":"select-trigger","data-size":t,className:o("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...l,children:[r,(0,a.jsx)(eV.JO,{asChild:!0,children:(0,a.jsx)(eM.Z,{className:"size-4 opacity-50"})})]})}function eK(e){let{className:s,children:t,position:r="popper",...l}=e;return(0,a.jsx)(eV.h_,{children:(0,a.jsxs)(eV.VY,{"data-slot":"select-content",className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...l,children:[(0,a.jsx)(eX,{}),(0,a.jsx)(eV.l_,{className:o("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(eJ,{})]})})}function eq(e){let{className:s,children:t,...r}=e;return(0,a.jsxs)(eV.ck,{"data-slot":"select-item",className:o("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(eV.wU,{children:(0,a.jsx)(X.Z,{className:"size-4"})})}),(0,a.jsx)(eV.eT,{children:t})]})}function eX(e){let{className:s,...t}=e;return(0,a.jsx)(eV.u_,{"data-slot":"select-scroll-up-button",className:o("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(eG.Z,{className:"size-4"})})}function eJ(e){let{className:s,...t}=e;return(0,a.jsx)(eV.$G,{"data-slot":"select-scroll-down-button",className:o("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(eM.Z,{className:"size-4"})})}var eY=t(2883),e$=t(5368),eQ=t(2934),e0=t(9322),e1=t(4064),e2=t(8477),e4=t(3229),e3=t(6475),e5=t(8728),e6=t(1706),e8=t(5805),e9=t(5287),e7=t(7806),se=t(1817),ss=t(9388),st=t(6748),sa=t(3643);function sr(e){let{className:s,children:t,...r}=e;return(0,a.jsxs)(sa.fC,{"data-slot":"scroll-area",className:o("relative",s),...r,children:[(0,a.jsx)(sa.l_,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,a.jsx)(sl,{}),(0,a.jsx)(sa.Ns,{})]})}function sl(e){let{className:s,orientation:t="vertical",...r}=e;return(0,a.jsx)(sa.gb,{"data-slot":"scroll-area-scrollbar",orientation:t,className:o("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",s),...r,children:(0,a.jsx)(sa.q4,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function sn(e){let{className:s,...t}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:o("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}var si=t(7845);function sc(e){let{delayDuration:s=0,...t}=e;return(0,a.jsx)(si.zt,{"data-slot":"tooltip-provider",delayDuration:s,...t})}function so(e){let{...s}=e;return(0,a.jsx)(sc,{children:(0,a.jsx)(si.fC,{"data-slot":"tooltip",...s})})}function sd(e){let{...s}=e;return(0,a.jsx)(si.xz,{"data-slot":"tooltip-trigger",...s})}function sm(e){let{className:s,sideOffset:t=0,children:r,...l}=e;return(0,a.jsx)(si.h_,{children:(0,a.jsxs)(si.VY,{"data-slot":"tooltip-content",sideOffset:t,className:o("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...l,children:[r,(0,a.jsx)(si.Eh,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var su=t(8124),sx=t(2023),sh=t(4743);function sp(){let[e,s]=(0,r.useState)([]),[t,a]=(0,r.useState)(!1),l=(0,r.useRef)(!1),n=e=>Array.from(new Set([...e.matchAll(/\{\{(\w+)\}\}/g)].map(e=>e[1]))).map(e=>({id:crypto.randomUUID(),name:e,defaultValue:""})),i=(e,s)=>{let t=e;return Object.keys(s).forEach(e=>{t=t.replace(RegExp("\\{\\{".concat(e,"\\}\\}"),"g"),s[e])}),t},c=async(e,t,r)=>{a(!0),l.current=!1;let n={...e,status:"processing"};s(s=>s.map(s=>s.id===e.id?n:s));try{for(let n=0;n<e.csvData.length;n++){if(l.current){console.log("Bulk generation cancelled by user"),r&&r(),s(s=>s.map(s=>s.id===e.id?{...s,status:"cancelled",progress:n/e.csvData.length*100}:s)),a(!1);return}let c=e.csvData[n],o=i(e.template,c);try{await t(o)}catch(e){console.error("Failed to generate item ".concat(n+1,":"),e)}let d=(n+1)/e.csvData.length*100;s(s=>s.map(s=>s.id===e.id?{...s,progress:d,results:[...s.results,{rowIndex:n,audioUrl:"",text:o}]}:s))}l.current||s(s=>s.map(s=>s.id===e.id?{...s,status:"completed"}:s))}catch(t){console.error("Bulk generation failed:",t),s(s=>s.map(s=>s.id===e.id?{...s,status:"failed"}:s))}finally{a(!1),l.current=!1}};return{jobs:e,isProcessing:t,parseCSV:e=>{let s=e.trim().split("\n");if(s.length<2)return[];let t=s[0].split(",").map(e=>e.trim()),a=[];for(let e=1;e<s.length;e++){let r=s[e].split(",").map(e=>e.trim()),l={};t.forEach((e,s)=>{l[e]=r[s]||""}),a.push(l)}return a},extractVariables:n,replaceVariables:i,createBulkJob:(e,s,t,a)=>{let r=n(e);return{id:crypto.randomUUID(),template:e,variables:r,csvData:s,voiceId:t,emotionId:a,status:"pending",progress:0,results:[],createdAt:new Date}},processBulkJob:c,cancelBulkGeneration:()=>{l.current=!0,a(!1),s(e=>e.map(e=>"processing"===e.status?{...e,status:"cancelled"}:e))}}}let sg=r.forwardRef((e,s)=>{let{value:t,onValueChange:r,onSubmit:l,onMicClick:n,onAIClick:i,onBulkClick:c,placeholder:d,disabled:m,isRecording:x,enterToSend:h,onEnterToSendChange:p,maxLength:g,className:f,...j}=e,v=sp();return(0,a.jsx)(sc,{delayDuration:200,children:(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"relative",children:[t&&!m&&(0,a.jsxs)(so,{children:[(0,a.jsx)(sd,{asChild:!0,children:(0,a.jsx)(u,{size:"icon",variant:"ghost",className:"absolute top-3 right-3 z-10 h-6 w-6 rounded-full",onClick:()=>r(""),children:(0,a.jsx)(A.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(sm,{children:(0,a.jsx)("p",{children:"Clear Text"})})]}),(0,a.jsx)(sn,{ref:s,value:t,onChange:e=>r(e.target.value),placeholder:d,className:o("pr-36 py-4 min-h-[140px] resize-none border-2 focus-visible:ring-primary/50",f),disabled:m,maxLength:g,...j}),(0,a.jsxs)("div",{className:"absolute bottom-3 right-3 flex items-center gap-2",children:[(0,a.jsxs)(so,{children:[(0,a.jsx)(sd,{asChild:!0,children:(0,a.jsx)(u,{size:"icon",variant:"outline",onClick:c,disabled:m||v.isProcessing,className:"shadow-lg hover:scale-105 transition-transform",children:(0,a.jsx)(su.Z,{className:"w-4 h-4"})})}),(0,a.jsx)(sm,{children:(0,a.jsx)("p",{children:"Bulk Generation"})})]}),(0,a.jsxs)(so,{children:[(0,a.jsx)(sd,{asChild:!0,children:(0,a.jsx)(u,{size:"icon",variant:"outline",onClick:i,disabled:m,className:"shadow-lg hover:scale-105 transition-transform",children:(0,a.jsx)(sx.Z,{className:"w-4 h-4"})})}),(0,a.jsx)(sm,{children:(0,a.jsx)("p",{children:"AI Assistant"})})]}),(0,a.jsxs)(so,{children:[(0,a.jsx)(sd,{asChild:!0,children:(0,a.jsx)(u,{size:"icon",variant:x?"destructive":"outline",onClick:n,disabled:m,className:"shadow-lg hover:scale-105 transition-transform",children:(0,a.jsx)(O.Z,{className:o("w-4 h-4",x&&"animate-pulse")})})}),(0,a.jsx)(sm,{children:(0,a.jsx)("p",{children:x?"Stop Recording":"Voice Input"})})]}),(0,a.jsxs)(so,{children:[(0,a.jsx)(sd,{asChild:!0,children:(0,a.jsx)(u,{size:"icon",onClick:l,disabled:m||!t.trim(),className:"shadow-lg hover:scale-105 transition-transform",children:(0,a.jsx)(sh.Z,{className:"w-4 h-4"})})}),(0,a.jsx)(sm,{children:(0,a.jsx)("p",{children:"Generate Audio"})})]})]})]})})})});sg.displayName="TextInputArea";var sf=t(4001);function sj(e){let{open:s,onOpenChange:t,currentText:l,onTextGenerated:n,speakerCount:i}=e,{isProcessing:c,error:o,improveScript:d,generateScript:m}=function(){let[e,s]=(0,r.useState)(!1),[t,a]=(0,r.useState)(null),l=async(e,s)=>{let t=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({model:"gpt-4o-mini",messages:[{role:"user",content:e}],temperature:.7})});if(!t.ok){var a;throw Error((null===(a=(await t.json()).error)||void 0===a?void 0:a.message)||"OpenAI API request failed")}return(await t.json()).choices[0].message.content},n=async(e,s)=>{let t=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":s,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:"claude-3-5-sonnet-20241022",max_tokens:2048,messages:[{role:"user",content:e}]})});if(!t.ok){var a;throw Error((null===(a=(await t.json()).error)||void 0===a?void 0:a.message)||"Claude API request failed")}return(await t.json()).content[0].text},i=async(e,s)=>{let t=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=".concat(s),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}]})});if(!t.ok){var a;throw Error((null===(a=(await t.json()).error)||void 0===a?void 0:a.message)||"Gemini API request failed")}return(await t.json()).candidates[0].content.parts[0].text};return{isProcessing:e,error:t,improveScript:async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;s(!0),a(null);try{if(!t.apiKey)throw Error("".concat(t.name," API key not found. Please add it in settings."));let s="Improve the following script for text-to-speech generation. Make it more natural, engaging, and suitable for voice synthesis. ".concat(r>1?"This is a multi-speaker dialogue with ".concat(r,' speakers. Use "Speaker 1:", "Speaker 2:", etc. format.'):"","\n\nOriginal script:\n").concat(e),a="";switch(t.id){case"chatgpt":a=await l(s,t.apiKey);break;case"claude":a=await n(s,t.apiKey);break;case"gemini":a=await i(s,t.apiKey)}return a}catch(e){throw a(e instanceof Error?e.message:"Failed to improve script"),e}finally{s(!1)}},generateScript:async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;s(!0),a(null);try{if(!t.apiKey)throw Error("".concat(t.name," API key not found. Please add it in settings."));let s='Generate a script for text-to-speech based on this prompt: "'.concat(e,'". ').concat(r>1?"Create a dialogue with ".concat(r,' speakers (max 4). Use "Speaker 1:", "Speaker 2:", etc. format.'):"Create a single-speaker script."," Make it natural and engaging for voice synthesis."),a="";switch(t.id){case"chatgpt":a=await l(s,t.apiKey);break;case"claude":a=await n(s,t.apiKey);break;case"gemini":a=await i(s,t.apiKey)}return a}catch(e){throw a(e instanceof Error?e.message:"Failed to generate script"),e}finally{s(!1)}}}}(),[x,h]=(0,r.useState)("chatgpt"),[p,g]=(0,r.useState)(""),[f,j]=(0,r.useState)({chatgpt:"",claude:"",gemini:""});(0,r.useEffect)(()=>{j({chatgpt:localStorage.getItem("openai_api_key")||"",claude:localStorage.getItem("claude_api_key")||"",gemini:localStorage.getItem("gemini_api_key")||""})},[]);let v=(e,s)=>{localStorage.setItem("chatgpt"===e?"openai_api_key":"".concat(e,"_api_key"),s),j(t=>({...t,[e]:s}))},y=async()=>{let e={id:x,name:"chatgpt"===x?"ChatGPT":"claude"===x?"Claude":"Gemini",apiKey:f[x]};try{let s=await d(l,e,i);n(s),t(!1)}catch(e){console.error("Failed to improve script:",e)}},b=async()=>{let e={id:x,name:"chatgpt"===x?"ChatGPT":"claude"===x?"Claude":"Gemini",apiKey:f[x]};try{let s=await m(p,e,i);n(s),t(!1)}catch(e){console.error("Failed to generate script:",e)}};return(0,a.jsx)(Z,{open:s,onOpenChange:t,children:(0,a.jsxs)(T,{className:"max-w-2xl",children:[(0,a.jsxs)(R,{children:[(0,a.jsxs)(P,{className:"flex items-center gap-2",children:[(0,a.jsx)(sx.Z,{className:"h-5 w-5 text-primary"}),"AI Script Assistant"]}),(0,a.jsx)(D,{children:"Use AI to improve your existing script or generate a new one (max 4 speakers)"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{children:"AI Provider"}),(0,a.jsxs)(eB,{value:x,onValueChange:e=>h(e),children:[(0,a.jsx)(eW,{children:(0,a.jsx)(eH,{})}),(0,a.jsxs)(eK,{children:[(0,a.jsx)(eq,{value:"chatgpt",children:"ChatGPT (GPT-4o-mini)"}),(0,a.jsx)(eq,{value:"claude",children:"Claude (Sonnet 3.5)"}),(0,a.jsx)(eq,{value:"gemini",children:"Gemini (2.0 Flash)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(w,{className:"flex items-center gap-2",children:[(0,a.jsx)(sf.Z,{className:"h-4 w-4"}),"API Key"]}),(0,a.jsx)(N,{type:"password",placeholder:"Enter your ".concat("chatgpt"===x?"OpenAI":"claude"===x?"Anthropic":"Google"," API key"),value:f[x],onChange:e=>v(x,e.target.value)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Your API key is stored locally and never sent to our servers"})]}),o&&(0,a.jsx)(el,{variant:"destructive",children:(0,a.jsx)(en,{children:o})}),(0,a.jsxs)(k,{defaultValue:"improve",className:"w-full",children:[(0,a.jsxs)(C,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(S,{value:"improve",children:"Improve Script"}),(0,a.jsx)(S,{value:"generate",children:"Generate New"})]}),(0,a.jsxs)(z,{value:"improve",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{children:"Current Script"}),(0,a.jsx)(sn,{value:l,readOnly:!0,className:"min-h-[150px] bg-muted/50",placeholder:"Enter text in the main input first"})]}),(0,a.jsx)(u,{onClick:y,disabled:!l||!f[x]||c,className:"w-full",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(se.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Improving..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sx.Z,{className:"mr-2 h-4 w-4"}),"Improve Script"]})})]}),(0,a.jsxs)(z,{value:"generate",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{children:"Describe what you want"}),(0,a.jsx)(sn,{value:p,onChange:e=>g(e.target.value),placeholder:"E.g., 'A friendly conversation between two friends about their weekend plans'",className:"min-h-[150px]"})]}),(0,a.jsx)(u,{onClick:b,disabled:!p||!f[x]||c,className:"w-full",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(se.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sx.Z,{className:"mr-2 h-4 w-4"}),"Generate Script"]})})]})]})]})]})})}var sv=t(8736),sN=t(2735),sy=t(7769),sw=t(2208);function sb(e){let{open:s,onOpenChange:t,onStartBulkGeneration:l}=e,[n,i]=(0,r.useState)(""),[c,o]=(0,r.useState)(""),[d,m]=(0,r.useState)(null),[x,h]=(0,r.useState)(null),[p,g]=(0,r.useState)([]),[f,j]=(0,r.useState)(!1),[y,b]=(0,r.useState)([]),_=e=>{let s=e.trim().split("\n");if(s.length<2)return[];let t=s[0].split(",").map(e=>e.trim()),a=[];for(let e=1;e<s.length;e++){let r=s[e].split(",").map(e=>e.trim()),l={};t.forEach((e,s)=>{l[e]=r[s]||""}),a.push(l)}return a},U=(e,s)=>e.replace(/\{\{(\w+)\}\}/g,(e,t)=>void 0!==s[t]?s[t]:e),E=(e=>{let s=e.matchAll(/\{\{(\w+)\}\}/g),t=new Set;for(let e of s)t.add(e[1]);return Array.from(t).map((e,s)=>({id:"var-".concat(s),name:e}))})(n),F=async e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(t){h(null),m(t);try{let e=await t.text();o(e);let s=_(e);g(s),0===s.length?h("CSV file appears to be empty or invalid"):console.log("Parsed CSV data:",s)}catch(e){h("Failed to read CSV file"),console.error(e)}}},I=n.trim()&&p.length>0&&E.length>0;return(0,a.jsx)(Z,{open:s,onOpenChange:t,children:(0,a.jsxs)(T,{className:"max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)(R,{children:[(0,a.jsxs)(P,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sv.Z,{className:"h-5 w-5 text-primary"}),"Bulk Speech Generation"]}),(0,a.jsxs)(u,{variant:"ghost",size:"sm",onClick:()=>{i(""),o(""),m(null),g([]),h(null),j(!1),b([])},className:"text-xs",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 mr-1"}),"Clear All"]})]}),(0,a.jsxs)(D,{children:["Create multiple speeches from a template and CSV data. Use"," ","{{variable}}"," syntax for placeholders."]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsxs)(k,{defaultValue:"setup",className:"w-full",children:[(0,a.jsxs)(C,{className:"grid w-full grid-cols-3",children:[(0,a.jsxs)(S,{value:"setup",children:["Setup",!I&&(0,a.jsx)("span",{className:"ml-2 text-yellow-500",children:""})]}),(0,a.jsxs)(S,{value:"data",children:["Data (",p.length,")",p.length>0&&(0,a.jsx)(eQ.Z,{className:"ml-2 h-3 w-3 text-green-500"})]}),(0,a.jsx)(S,{value:"preview",disabled:!n||0===p.length,children:"Preview"})]}),(0,a.jsxs)(z,{value:"setup",className:"space-y-4 mt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w,{children:"Template Text"}),n&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[n.length," characters"]})]}),(0,a.jsx)(sn,{value:n,onChange:e=>i(e.target.value),placeholder:"Hello {{name}}, welcome to {{company}}! Your order {{order_id}} is ready for pickup.",className:"min-h-[120px] font-mono text-sm"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["\uD83D\uDCA1 Tip: Use ","{{variable_name}}"," to insert values from your CSV columns"]})]}),E.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(w,{className:"flex items-center gap-2",children:["Detected Variables",(0,a.jsx)(v,{variant:"secondary",children:E.length})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:E.map(e=>(0,a.jsx)(v,{variant:"outline",className:"font-mono",children:"{{".concat(e.name,"}}")},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w,{children:"CSV Data Source"}),(0,a.jsxs)(u,{variant:"ghost",size:"sm",onClick:()=>{let e=new Blob(["name,company,order_id,product,quantity,status\nJohn Doe,Acme Corp,12345,Widget Pro,5,ready\nJane Smith,Tech Solutions,67890,Smart Device,2,ready\nBob Johnson,StartUp Inc,11111,Premium Package,1,ready"],{type:"text/csv"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="sample-bulk-generation.csv",t.click(),URL.revokeObjectURL(s)},className:"text-xs",children:[(0,a.jsx)(sN.Z,{className:"h-3 w-3 mr-1"}),"Sample CSV"]})]}),(0,a.jsxs)("div",{className:"grid gap-3",children:[(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-4 hover:border-primary/50 transition-colors",children:[(0,a.jsx)(N,{type:"file",accept:".csv",onChange:F,className:"hidden",id:"csv-upload"}),(0,a.jsx)("label",{htmlFor:"csv-upload",className:"cursor-pointer block",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,a.jsx)(V.Z,{className:"h-6 w-6 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:d?d.name:"Upload CSV File"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Click to browse or drag and drop"})]})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{className:"text-xs text-muted-foreground",children:"Or paste CSV data"}),(0,a.jsx)(sn,{value:c,onChange:e=>o(e.target.value),placeholder:"name,company,order_id John Doe,Acme Corp,12345 Jane Smith,Tech Co,67890",className:"min-h-[100px] font-mono text-xs"}),(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:()=>{if(!c.trim()){h("Please paste CSV data first");return}try{let e=_(c);g(e),m(null),0===e.length?h("CSV data appears to be empty or invalid"):(h(null),console.log("Parsed CSV data:",e))}catch(e){h("Failed to parse CSV data"),console.error(e)}},disabled:!c.trim(),className:"w-full",children:"Parse CSV Data"})]})]})]})]}),(0,a.jsx)(z,{value:"data",className:"mt-4",children:0===p.length?(0,a.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,a.jsx)(sv.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"No data loaded yet"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Upload a CSV file or paste data in the Setup tab"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:[p.length," rows "," ",Object.keys(p[0]).length," columns"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"First row contains headers"})]}),(0,a.jsxs)(v,{variant:"secondary",children:[(0,a.jsx)(eQ.Z,{className:"h-3 w-3 mr-1"}),"Valid"]})]}),(0,a.jsx)(sr,{className:"h-[300px] rounded-md border",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left p-2 font-medium bg-muted",children:"#"}),Object.keys(p[0]).map(e=>(0,a.jsx)("th",{className:"text-left p-2 font-medium bg-muted",children:e},e))]})}),(0,a.jsx)("tbody",{children:p.map((e,s)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-muted/50",children:[(0,a.jsx)("td",{className:"p-2 text-muted-foreground",children:s+1}),Object.values(e).map((e,s)=>(0,a.jsx)("td",{className:"p-2 font-mono text-xs",children:e},s))]},s))})]})})})]})}),(0,a.jsx)(z,{value:"preview",className:"mt-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Preview the first 3 generated speeches"}),(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:()=>{n.trim()&&0!==p.length&&(b(p.slice(0,3).map(e=>U(n,e))),j(!0))},children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sy.Z,{className:"h-4 w-4 mr-2"}),"Regenerate"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sw.Z,{className:"h-4 w-4 mr-2"}),"Generate Preview"]})})]}),f&&y.length>0?(0,a.jsx)(sr,{className:"h-[300px]",children:(0,a.jsx)("div",{className:"space-y-3",children:y.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 bg-muted/30",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,a.jsxs)(v,{variant:"secondary",children:["Row ",s+1]})}),(0,a.jsx)("p",{className:"text-sm",children:e})]},s))})}):(0,a.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,a.jsx)(sw.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:'Click "Generate Preview" to see examples'})]})]})})]})}),x&&(0,a.jsxs)(el,{variant:"destructive",className:"mt-4",children:[(0,a.jsx)(e0.Z,{className:"h-4 w-4"}),(0,a.jsx)(en,{children:x})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,a.jsx)(u,{variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancel"}),(0,a.jsx)(u,{onClick:()=>{console.log("Start button clicked"),console.log("Template:",n),console.log("Parsed data:",p),console.log("Variables:",E);try{if(h(null),!n.trim()){h("Please enter a template");return}if(0===p.length){h("Please upload or paste valid CSV data");return}let e=Object.keys(p[0]);console.log("CSV Headers:",e);let s=E.filter(s=>!e.includes(s.name));if(s.length>0){h("Missing columns in CSV: ".concat(s.map(e=>e.name).join(", ")));return}console.log("Calling onStartBulkGeneration with:",{template:n,parsedData:p}),l(n,p),t(!1),setTimeout(()=>{i(""),o(""),m(null),g([]),h(null),j(!1),b([])},300)}catch(e){console.error("Error in handleStart:",e),h(e instanceof Error?e.message:"Failed to start bulk generation")}},disabled:!I,className:"flex-1",children:p.length>0?(0,a.jsxs)(a.Fragment,{children:["Generate ",p.length," Speeches"]}):(0,a.jsx)(a.Fragment,{children:"Start Bulk Generation"})})]})]})})}var sk=t(105);let sC=[{title:"Multi-Speaker Dialogue",examples:[{text:"Speaker 1: Hello, how are you?\nSpeaker 2: I'm doing well, thanks!",description:"Use 'Speaker X:' labels and new lines to assign text."},{text:"Speaker 1: I'll start.\nSpeaker 2: Then I will continue.\nSpeaker 1: And I will finish.",description:"The order of speakers in the text must match the order you selected them in the UI."}]},{title:"Pauses and Timing",examples:[{text:"Hello... world",description:"Short pause (0.5s)"},{text:"Hello...... world",description:"Medium pause (1s)"},{text:"Hello.......... world",description:"Long pause (2s)"},{text:"Hello, world",description:"Natural comma pause"},{text:"Hello. World.",description:"Sentence break pause"}]},{title:"Emphasis and Tone",examples:[{text:"*Hello* world",description:"Emphasis on 'Hello'"},{text:"**IMPORTANT** message",description:"Strong emphasis"},{text:"Hello ~world~",description:"Whispered tone"},{text:"Hello WORLD!",description:"Louder/excited tone"}]},{title:"Speech Patterns",examples:[{text:"Um... let me think",description:"Natural hesitation"},{text:"Well, you know...",description:"Conversational filler"},{text:"Question mark tone?",description:"Rising intonation"},{text:"Exclamation point!",description:"Excited delivery"}]},{title:"Pronunciation Guide",examples:[{text:"Dr. Smith",description:"Abbreviations"},{text:"NASA (NAH-sah)",description:"Phonetic spelling"},{text:"2023 (twenty twenty-three)",description:"Number pronunciation"},{text:"AI (A-I)",description:"Letter-by-letter"}]}];function sS(){let{setText:e,selectedVoiceId:s,selectedEmotionId:t,voices:l,isServerSetupComplete:n,serverConfig:i}=(0,I.m)(),[c,o]=(0,r.useState)("single"),[d,m]=(0,r.useState)([]),[h,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)(""),[j,y]=(0,r.useState)("generate"),[w,b]=(0,r.useState)(!0),[k,C]=(0,r.useState)(!1),[S,z]=(0,r.useState)(!1),[_,E]=(0,r.useState)([]),[F,D]=(0,r.useState)(!1),[L,O]=(0,r.useState)(!1),[V,M]=(0,r.useState)(""),[G,B]=(0,r.useState)([]),[H,W]=(0,r.useState)(-1),[q,X]=(0,r.useState)(!1),[J,Y]=(0,r.useState)(1e3),[$,Q]=(0,r.useState)(!0),[ee,es]=(0,r.useState)(!1),[et,er]=(0,r.useState)(""),[ei,ec]=(0,r.useState)(""),eo=(0,r.useRef)(!1),ed=function(){let{setProcessing:e,addGeneratedAudio:s,getVoiceSampleBlob:t,serverConfig:a}=(0,I.m)(),[l,n]=(0,r.useState)(0),[i,c]=(0,r.useState)(""),[o,d]=(0,r.useState)(null),[m,u]=(0,r.useState)(null),[x,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[f,j]=(0,r.useState)(0),v=(0,r.useRef)(null),N=e=>{let s=e.trim();return s?s.length>1e4?{valid:!1,error:"Text is too long (".concat(s.length," characters). Maximum is ").concat(1e4," characters.")}:{valid:!0}:{valid:!1,error:"Text cannot be empty"}},y=e=>new Promise(s=>setTimeout(s,e)),w=e=>["Failed to fetch","Network error","timeout","503","502","504","ECONNREFUSED"].some(s=>e.message.toLowerCase().includes(s.toLowerCase())),b=(0,r.useCallback)(()=>{v.current&&(v.current.abort(),g(!0),e(!1),h(!1),n(0),c(""),j(0),d("Generation cancelled by user"),setTimeout(()=>d(null),3e3))},[e]),k=async(e,s,r,l,i)=>{j(e);try{let o;let d=N(s);if(!d.valid)throw Error(d.error);c("Fetching voice samples..."),n(20);let m=new FormData;if(m.append("text",s),i)(await Promise.all(i.map(e=>t(e.id,null)))).forEach((e,s)=>{if(!e)throw Error("Could not find audio sample for speaker ".concat(s+1,": ").concat(i[s].name,"."));m.append("voice_files",new File([e],"speaker_".concat(s+1,".wav")))}),o="".concat(a.url,"/multi-speaker");else{let e=await t(r,l);if(!e)throw Error("Could not find the selected voice audio sample.");m.append("voice_file",new File([e],"voice_sample.wav")),o="".concat(a.url,"/single-speaker")}n(40),c(e>1?"Generating speech (attempt ".concat(e,")..."):"Generating speech..."),n(60),v.current=new AbortController;let u=setTimeout(()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.abort()},12e4),x=await fetch(o,{method:"POST",body:m,signal:v.current.signal});if(clearTimeout(u),!x.ok){let e="Server error: ".concat(x.status);try{let s=await x.json();e=s.detail||s.message||e}catch(s){e=await x.text()||e}throw Error(e)}c("Processing audio..."),n(70);let h=await x.blob();if(!h||0===h.size)throw Error("Received empty audio data from server");if(c("Saving audio..."),n(80),!await C(h,s,r,l,i))throw Error("Failed to save generated audio to storage");return n(100),h}catch(a){let t=a instanceof Error?a:Error(String(a));if("AbortError"===t.name&&p)throw Error("Generation cancelled by user");if("AbortError"===t.name){let t=Error("Request timed out.");if(e<3)return await y(2e3*e),k(e+1,s,r,l,i);throw t}if(e<3&&w(t))return await y(2e3*e),k(e+1,s,r,l,i);throw t}},C=async(e,t,a,r,l)=>{try{c("Finalizing audio..."),n(80);let i={id:crypto.randomUUID(),text:t,voiceId:l?l.map(e=>e.id).join(","):a,emotionId:null!=r?r:void 0,audioUrl:sk.C.createObjectURL(e),createdAt:new Date};return await s(i,e),c("Complete!"),n(100),u("Audio generated successfully!"),setTimeout(()=>u(null),3e3),!0}catch(e){return console.error("Failed to save audio:",e),!1}};return{progress:l,processingStage:i,error:o,success:m,isGenerating:x,retryAttempt:f,handleGenerate:async(s,t,r,l)=>{if(a){e(!0),h(!0),g(!1),d(null),u(null),c("Preparing voice model..."),n(10),j(0);try{await k(1,s,t,r,l)&&!p&&(u("Audio generated and saved successfully!"),setTimeout(()=>u(null),3e3))}catch(e){console.error("Audio generation failed:",e),d(e instanceof Error?e.message:"Failed to generate audio"),setTimeout(()=>d(null),5e3)}finally{e(!1),h(!1),n(0),c(""),j(0),v.current=null}}},handleCancel:b,setError:d,setSuccess:u}}(),em=function(){let{getVoiceSampleBlob:e,serverConfig:s,addGeneratedAudio:t,currentText:a,selectedVoiceId:l,selectedEmotionId:n}=(0,I.m)(),[i,c]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(""),[x,h]=(0,r.useState)(null),[p,g]=(0,r.useState)(null),f=(0,r.useRef)(null),j=(0,r.useRef)(null),v=(0,r.useRef)([]),N=(0,r.useRef)(!1),y=(0,r.useRef)(0),w=(0,r.useRef)([]),b=(0,r.useRef)(!1),k=(0,r.useRef)([]),C=(0,r.useRef)(null),S=(0,r.useCallback)(()=>{if(!s||j.current)return;console.log("Attempting to connect WebSocket..."),u("Connecting to server...");let e=s.url.replace("http://","ws://").replace("https://","wss://"),t=new WebSocket("".concat(e,"/ws/tts-stream"));j.current=t,t.onopen=()=>{console.log("WebSocket connected"),c(!0),u(""),h(null)},t.onmessage=e=>{try{let s=JSON.parse(e.data);if("ready"===s.type)d(!0),u("Streaming audio...");else if("audio_chunk"===s.type){let e=s.audio_data,t=new Uint8Array(e.match(/.{1,2}/g).map(e=>parseInt(e,16)));U(t,s.sample_rate||24e3,s.chunk_id)}else if("complete"===s.type)A();else if("error"===s.type)throw Error(s.message||"Streaming error")}catch(e){console.error("Failed to process message:",e),h(e instanceof Error?e.message:"Unknown error"),_(!1)}},t.onerror=e=>{console.error("WebSocket error:",e),h("Connection error. Check server and refresh."),c(!1)},t.onclose=()=>{console.log("WebSocket closed"),j.current=null,c(!1),setTimeout(()=>{console.log("Attempting to reconnect..."),S()},5e3)}},[s]);(0,r.useEffect)(()=>(S(),()=>{var e;null===(e=j.current)||void 0===e||e.close(),P()}),[S]);let z=async(s,t,a,r)=>{if(!j.current||j.current.readyState!==WebSocket.OPEN)try{S()}catch(e){h("Connecting to server failed.");return}if(o){h("You're already streaming");return}T(),k.current=[],C.current={text:s,voiceId:t,emotionId:a},h(null),g(null),d(!0),u("Preparing voice samples...");try{var l;await R();let n=[];if(r)for(let s of(await Promise.all(r.map(s=>e(s.id,null))))){if(!s)throw Error("Voice sample not found.");let e=await s.arrayBuffer(),t=btoa(new Uint8Array(e).reduce((e,s)=>e+String.fromCharCode(s),""));n.push({data:t})}else{let s=await e(t,a);if(!s)throw Error("Voice sample not found.");let r=await s.arrayBuffer(),l=btoa(new Uint8Array(r).reduce((e,s)=>e+String.fromCharCode(s),""));n.push({data:l})}u("Preparing to stream..."),null===(l=j.current)||void 0===l||l.send(JSON.stringify({text:s,type:r?"multi":"single",voice_files:n}))}catch(e){console.error("Streaming error:",e),h(e instanceof Error?e.message:"Streaming failed"),d(!1),u("")}},_=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];T(),e&&j.current&&j.current.readyState===WebSocket.OPEN&&j.current.send(JSON.stringify({type:"stop"})),b.current=!1,d(!1),u(""),C.current=null},A=()=>{b.current=!0,u("Finalizing audio...");let e=()=>{v.current.length>0||N.current||w.current.length>0?setTimeout(e,200):setTimeout(async()=>{let e=C.current;if(!e){console.error("No stream metadata available"),_(!1);return}let s=E(k.current,24e3);console.log("Created WAV blob:",s.size,"bytes"),await F(s,e.text,e.voiceId,e.emotionId),_(!1),g("Stream completed successfully"),setTimeout(()=>g(null),3e3)},200)};e()},Z=(0,r.useCallback)(()=>{let e=f.current;if(!e||0===v.current.length||N.current)return;N.current=!0;let s=()=>{if(0===v.current.length){N.current=!1;return}let{buffer:t}=v.current.shift(),a=e.createBufferSource(),r=e.createGain();w.current.push(a),a.buffer=t,a.connect(r),r.connect(e.destination);let l=Math.max(e.currentTime,y.current);r.gain.setValueAtTime(0,l),r.gain.linearRampToValueAtTime(1,l+.003),r.gain.setValueAtTime(1,l+t.duration-.003),r.gain.linearRampToValueAtTime(0,l+t.duration),a.start(l),y.current=l+t.duration,a.onended=()=>{w.current=w.current.filter(e=>e!==a),a.disconnect(),r.disconnect(),s()}};s()},[]),U=(0,r.useCallback)((e,s,t)=>{let a=f.current;if(!a)return;k.current.push(new Uint8Array(e));let r=new Int16Array(e.buffer,e.byteOffset,e.byteLength/2),l=new Float32Array(r.length);for(let e=0;e<r.length;e++)l[e]=r[e]/32768;let n=a.createBuffer(1,l.length,s);n.getChannelData(0).set(l),v.current.push({buffer:n,id:t}),v.current.length>=3&&!N.current&&Z()},[Z]),E=(e,s)=>{let t=e.reduce((e,s)=>e+s.length,0),a=new ArrayBuffer(44+t),r=new DataView(a),l=(e,s)=>{for(let t=0;t<s.length;t++)r.setUint8(e+t,s.charCodeAt(t))};l(0,"RIFF"),r.setUint32(4,36+t,!0),l(8,"WAVE"),l(12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,1,!0),r.setUint32(24,s,!0),r.setUint32(28,2*s,!0),r.setUint16(32,2,!0),r.setUint16(34,16,!0),l(36,"data"),r.setUint32(40,t,!0);let n=44,i=new Uint8Array(a);for(let s of e)i.set(s,n),n+=s.length;return new Blob([a],{type:"audio/wav"})},F=async(e,s,a,r)=>{try{let l={id:crypto.randomUUID(),text:s,voiceId:a,emotionId:null!=r?r:void 0,audioUrl:sk.C.createObjectURL(e),createdAt:new Date};return await t(l,e),!0}catch(e){return console.error("Failed to save audio:",e),!1}},T=()=>{w.current.forEach(e=>{try{e.onended=null,e.stop(),e.disconnect()}catch(e){}}),w.current=[],v.current=[],N.current=!1,y.current=0},R=(0,r.useCallback)(async()=>{if(!f.current||"running"!==f.current.state){if(f.current&&"closed"===f.current.state&&(f.current=null),!f.current){let e=window.AudioContext||window.webkitAudioContext;if(!e)throw Error("Web Audio API is not supported in this browser.");f.current=new e}if("suspended"===f.current.state&&await f.current.resume(),"running"!==f.current.state)throw Error("Could not activate audio. Please click a button to start streaming.")}},[]),P=()=>{T(),f.current&&"closed"!==f.current.state&&(f.current.close().catch(console.error),f.current=null)};return{isConnected:i,isStreaming:o,processingStage:m,error:x,success:p,handleStartStreaming:z,handleStopStreaming:_}}(),eu=function(e){let[s,t]=(0,r.useState)(!1),[a,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),c=(0,r.useRef)(null),o=(0,r.useRef)([]),d=(0,r.useCallback)(async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e);c.current=s,o.current=[],s.ondataavailable=e=>{e.data.size>0&&o.current.push(e.data)},s.onstop=async()=>{let s=new Blob(o.current,{type:"audio/webm"});await u(s),e.getTracks().forEach(e=>e.stop())},s.start(),t(!0),i(null)}catch(e){console.error("Failed to start recording:",e),i("Failed to access microphone. Please check permissions.")}},[]),m=(0,r.useCallback)(()=>{c.current&&s&&(c.current.stop(),t(!1))},[s]),u=async s=>{l(!0),i(null);try{let a=localStorage.getItem("openai_api_key");if(!a)throw Error("OpenAI API key not found. Please add it in settings.");let r=new FormData;r.append("file",s,"recording.webm"),r.append("model","whisper-1");let l=await fetch("https://api.openai.com/v1/audio/transcriptions",{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:r});if(!l.ok){var t;let e=await l.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Transcription failed")}let n=await l.json();e(n.text)}catch(e){console.error("Transcription error:",e),i(e instanceof Error?e.message:"Failed to transcribe audio")}finally{l(!1)}};return{isRecording:s,isTranscribing:a,error:n,startRecording:d,stopRecording:m}}(e=>{f(s=>s+(s?" ":"")+e)}),ex=sp();(0,r.useEffect)(()=>{let e=localStorage.getItem("tts-templates");if(e)try{E(JSON.parse(e))}catch(e){console.error("Failed to load templates:",e)}let s=localStorage.getItem("openai-api-key");s&&ec(s)},[]),(0,r.useEffect)(()=>{_.length>0&&localStorage.setItem("tts-templates",JSON.stringify(_))},[_]),(0,r.useEffect)(()=>{if(eo.current){eo.current=!1;return}if(g!==(G[H]||"")){let e=G.slice(0,H+1);e.push(g),e.length>50&&e.shift(),B(e),W(e.length-1)}},[g]);let eh=l.find(e=>e.id===s),ep=null==eh?void 0:eh.emotions.find(e=>e.id===t),eg=g.trim()&&("single"===c?!!s:d.length>1)&&!ed.isGenerating&&!em.isStreaming&&n;(0,r.useEffect)(()=>{em.isStreaming&&em.handleStopStreaming()},[s,d]);let ef=e=>{m(d.filter(s=>s.id!==e))},ej=(0,r.useCallback)(()=>{eg&&(e(g),console.log("Initiating generation with mode:",j,g),"generate"===j?ed.handleGenerate(g,"single"===c?s:d[0].id,"single"===c?t:null,"multi"===c?d:void 0):em.handleStartStreaming(g,"single"===c?s:d[0].id,"stream"===j?t:null,"multi"===c?d:void 0))},[eg,g,e,j,c,s,t,d,ed,em]),ev=async(e,a)=>{console.log("Starting bulk generation for",a.length,"items");let r=ex.createBulkJob(e,a,"single"===c?s:d[0].id,"single"===c&&t||void 0);await ex.processBulkJob(r,async e=>{for(console.log("Generating audio for:",e.substring(0,50)+"..."),await ed.handleGenerate(e,"single"===c?s:d[0].id,"single"===c?t:null,"multi"===c?d:void 0);ed.isGenerating;)await new Promise(e=>setTimeout(e,100));await new Promise(e=>setTimeout(e,J))},()=>{ed.handleCancel(),console.log("Single generation task cancelled as part of bulk cancellation.")}),console.log("Bulk generation process finished (completed or cancelled).")},eN=()=>{V.trim()&&(E([..._,{id:Date.now().toString(),name:V.trim(),text:g,generationType:c,speakers:"multi"===c?d:void 0,createdAt:Date.now()}]),M(""),O(!1))},ey=e=>{f(e.text),o(e.generationType),e.speakers&&m(e.speakers),D(!1)},ew=e=>{E(_.filter(s=>s.id!==e))},eb=()=>{H>0&&(eo.current=!0,W(H-1),f(G[H-1]))},ek=()=>{H<G.length-1&&(eo.current=!0,W(H+1),f(G[H+1]))},eC=()=>{et.trim()&&(ec(et),localStorage.setItem("openai-api-key",et),es(!1),er(""))},eS=H<G.length-1,ez=[ed.error,em.error,eu.error].filter(Boolean),e_=ez.length>0?ez.join(" | "):null,eA=ed.success||em.success,eZ=ed.isGenerating||em.isStreaming||ex.isProcessing,eU=1e4-g.length;return(0,a.jsxs)(x,{className:"p-6 w-full border-2 shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center flex-wrap gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,a.jsx)(eY.Z,{className:"h-5 w-5 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Audio Generation"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Create speech from any voice."})]}),(0,a.jsxs)(Z,{open:h,onOpenChange:p,children:[(0,a.jsx)(U,{asChild:!0,children:(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"gap-2 hover:bg-primary/5",children:[(0,a.jsx)(e$.Z,{className:"h-4 w-4"}),"Formatting Guide"]})}),(0,a.jsxs)(T,{className:"max-w-3xl max-h-[80vh]",children:[(0,a.jsx)(R,{children:(0,a.jsxs)(P,{className:"flex items-center gap-2",children:[(0,a.jsx)(e$.Z,{className:"h-5 w-5"})," Text Formatting Guide"]})}),(0,a.jsx)(sr,{className:"max-h-[60vh]",children:(0,a.jsxs)("div",{className:"space-y-6 pr-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-4 rounded-lg border border-primary/20",children:[(0,a.jsxs)("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[(0,a.jsx)(eQ.Z,{className:"h-4 w-4 text-primary"}),"Quick Tips"]}),(0,a.jsxs)("ul",{className:"text-sm space-y-2 text-muted-foreground",children:[(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary mt-0.5",children:""}),"Use natural punctuation for realistic speech patterns"]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary mt-0.5",children:""}),"Add pauses with dots (...) for dramatic effect"]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary mt-0.5",children:""}),"Use *asterisks* for emphasis and ~tildes~ for whispers"]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary mt-0.5",children:""}),'For multi-speaker, use "Speaker 1:", "Speaker 2:", etc.']})]})]}),sC.map((e,s)=>(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-1 w-1 rounded-full bg-primary"}),e.title]}),(0,a.jsx)("div",{className:"grid gap-3",children:e.examples.map((e,s)=>(0,a.jsxs)("div",{className:"bg-card border rounded-lg p-3 hover:border-primary/50 transition-colors",children:[(0,a.jsx)("div",{className:"font-mono text-sm bg-muted/70 p-3 rounded-md mb-2 border",children:e.text}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-primary mt-0.5",children:""}),e.description]})]},s))})]},s)),(0,a.jsxs)("div",{className:"bg-blue-500/10 p-4 rounded-lg border border-blue-500/20",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Keyboard Shortcuts"}),(0,a.jsxs)("ul",{className:"text-sm space-y-1 text-muted-foreground",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:"Ctrl/Cmd + Enter"})," ","- Generate audio"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:"Esc"})," ","- Cancel generation"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:"Ctrl/Cmd + Z"})," ","- Undo"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:"Ctrl/Cmd + Shift + Z"})," ","- Redo"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("kbd",{className:"px-2 py-1 bg-muted rounded text-xs",children:"Ctrl/Cmd + S"})," ","- Save as template"]})]})]})]})})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-muted/50 rounded-lg border",children:[(0,a.jsx)(eL.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(eO,{})]})]}),e_&&(0,a.jsxs)(el,{className:"mb-4 border-destructive/50 bg-destructive/10 text-destructive dark:border-destructive animate-in fade-in slide-in-from-top-2 duration-300",children:[(0,a.jsx)(e0.Z,{className:"h-4 w-4"}),(0,a.jsx)(en,{className:"font-medium",children:e_})]}),eA&&(0,a.jsxs)(el,{className:"mb-4 border-green-500/50 bg-green-500/10 text-green-700 dark:text-green-400 dark:border-green-500 animate-in fade-in slide-in-from-top-2 duration-300",children:[(0,a.jsx)(eQ.Z,{className:"h-4 w-4"}),(0,a.jsx)(en,{className:"font-medium",children:eA})]}),!n&&(0,a.jsxs)(el,{className:"mb-4 border-yellow-500/50 bg-yellow-500/10 text-yellow-700 dark:text-yellow-400 dark:border-yellow-500",children:[(0,a.jsx)(e0.Z,{className:"h-4 w-4"}),(0,a.jsx)(en,{className:"font-medium",children:"Server setup required to generate audio."})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:eb,disabled:!(H>0)||eZ,title:"Undo (Ctrl+Z)",children:(0,a.jsx)(e1.Z,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:ek,disabled:!eS||eZ,title:"Redo (Ctrl+Shift+Z)",children:(0,a.jsx)(e2.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(u,{variant:"outline",size:"sm",onClick:()=>O(!0),disabled:!g.trim()||eZ,title:"Save as template (Ctrl+S)",children:[(0,a.jsx)(e4.Z,{className:"h-4 w-4 mr-2"}),"Save"]}),(0,a.jsxs)(u,{variant:"outline",size:"sm",onClick:()=>D(!0),disabled:eZ,children:[(0,a.jsx)(e3.Z,{className:"h-4 w-4 mr-2"}),"Load"]}),(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:()=>X(!0),children:(0,a.jsx)(e5.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-primary"}),"Generation Type"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(u,{variant:"single"===c?"default":"outline",size:"sm",onClick:()=>o("single"),disabled:eZ,className:"flex-1 transition-all",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4 mr-2"})," Single"]}),(0,a.jsxs)(u,{variant:"multi"===c?"default":"outline",size:"sm",onClick:()=>o("multi"),disabled:eZ,className:"flex-1 transition-all",children:[(0,a.jsx)(e8.Z,{className:"h-4 w-4 mr-2"})," Multi"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,a.jsx)(eY.Z,{className:"h-4 w-4 text-primary"}),"Generation Mode"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(u,{variant:"generate"===j?"default":"outline",size:"sm",onClick:()=>y("generate"),disabled:eZ,className:"flex-1 transition-all",children:[(0,a.jsx)(eY.Z,{className:"h-4 w-4 mr-2"})," File"]}),(0,a.jsxs)(u,{variant:"stream"===j?"default":"outline",size:"sm",onClick:()=>y("stream"),disabled:eZ,className:"flex-1 transition-all",children:[(0,a.jsx)(e9.Z,{className:"h-4 w-4 mr-2"})," Live"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Text Input"}),$&&(0,a.jsxs)("span",{className:"text-xs ".concat(eU<500?"text-destructive":eU<2e3?"text-yellow-600":"text-muted-foreground"),children:[eU.toLocaleString()," characters remaining"]})]}),(0,a.jsx)(sg,{value:g,onValueChange:f,onSubmit:ej,onKeyDown:e=>{if((e.ctrlKey||e.metaKey)&&"Enter"===e.key){e.preventDefault(),ej();return}if("Escape"===e.key&&(ed.isGenerating||em.isStreaming)){e.preventDefault(),ed.isGenerating?ed.handleCancel():em.handleStopStreaming();return}if((e.ctrlKey||e.metaKey)&&"z"===e.key&&!e.shiftKey){e.preventDefault(),eb();return}if((e.ctrlKey||e.metaKey)&&e.shiftKey&&"z"===e.key||(e.ctrlKey||e.metaKey)&&"y"===e.key){e.preventDefault(),ek();return}if((e.ctrlKey||e.metaKey)&&"s"===e.key){e.preventDefault(),O(!0);return}w&&"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),ej())},onMicClick:()=>{if(!ei){es(!0);return}if("stream"!==j){ed.setError("Voice recording only works with Live streaming mode. Switch to Live mode to use this feature."),setTimeout(()=>ed.setError(null),4e3);return}eu.isRecording?eu.stopRecording():eu.startRecording()},onAIClick:()=>C(!0),onBulkClick:()=>z(!0),placeholder:"multi"===c?"Enter dialogue with speaker labels (e.g., 'Speaker 1: Hello!')":eh?"Enter text for ".concat(eh.name,"'s voice..."):"Select a voice, then enter text...",disabled:eZ,isRecording:eu.isRecording||eu.isTranscribing,enterToSend:w,onEnterToSendChange:b,maxLength:1e4})]})]}),(0,a.jsx)("div",{className:"space-y-4 my-6",children:"single"===c?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-primary"}),"Selected Voice"]}),(0,a.jsx)("div",{className:"p-4 bg-gradient-to-r from-muted/50 to-muted/30 rounded-lg border-2 border-muted hover:border-primary/50 transition-colors",children:eh?(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-primary/10 rounded-full",children:(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:eh.name}),ep&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[ep.name," emotion"]})]})]}),ep&&(0,a.jsx)(v,{variant:"secondary",className:"ml-auto",children:ep.name})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(e0.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:"No voice selected"})]})})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,a.jsx)(e8.Z,{className:"h-4 w-4 text-primary"}),"Selected Speakers (",d.length,")"]}),(0,a.jsxs)("div",{className:"p-4 bg-gradient-to-r from-muted/50 to-muted/30 rounded-lg border-2 border-muted space-y-3",children:[d.length>0?(0,a.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:d.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-background/80 backdrop-blur-sm p-3 rounded-lg border hover:border-primary/50 transition-all group",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(v,{variant:"default",className:"min-w-[90px]",children:["Speaker ",s+1]}),(0,a.jsx)("span",{className:"font-medium text-sm",children:e.name})]}),(0,a.jsx)(u,{variant:"ghost",size:"icon",className:"h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-destructive/10 hover:text-destructive",onClick:()=>ef(e.id),disabled:eZ,children:(0,a.jsx)(A.Z,{className:"h-4 w-4"})})]},e.id))}):(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground py-2",children:[(0,a.jsx)(e0.Z,{className:"h-4 w-4"}),(0,a.jsx)("p",{className:"text-sm",children:"Add at least 2 speakers to begin."})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2 border-t",children:[(0,a.jsxs)(eB,{onValueChange:e=>{let s=l.find(s=>s.id===e);s&&!d.find(s=>s.id===e)&&m([...d,{id:s.id,name:s.name}])},disabled:eZ,children:[(0,a.jsx)(eW,{className:"flex-1 border-2 hover:border-primary/50 transition-colors",children:(0,a.jsx)(eH,{placeholder:"Add a speaker..."})}),(0,a.jsx)(eK,{children:l.filter(e=>!d.some(s=>s.id===e.id)).map(e=>(0,a.jsx)(eq,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(e6.Z,{className:"h-3 w-3"}),e.name]})},e.id))})]}),(0,a.jsx)(u,{variant:"outline",size:"icon",className:"shrink-0",disabled:l.length===d.length||eZ,children:(0,a.jsx)(e7.Z,{className:"h-4 w-4"})})]})]})]})}),eZ&&(0,a.jsxs)("div",{className:"space-y-4 mb-6 p-4 bg-gradient-to-r from-primary/5 to-primary/10 rounded-lg border-2 border-primary/20",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(se.Z,{className:"h-5 w-5 animate-spin text-primary"}),em.isStreaming&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-red-500 rounded-full animate-pulse"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:em.processingStage||ed.processingStage}),ed.retryAttempt>1&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Attempt ",ed.retryAttempt," of 3"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[em.isStreaming&&(0,a.jsxs)(v,{variant:"destructive",className:"animate-pulse",children:[(0,a.jsx)(e9.Z,{className:"h-3 w-3 mr-1"}),"LIVE"]}),ed.retryAttempt>1&&(0,a.jsxs)(v,{variant:"secondary",children:["Retry ",ed.retryAttempt,"/3"]})]})]}),ed.isGenerating&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ea,{value:ed.progress,className:"h-2"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground text-center",children:[Math.round(ed.progress),"% complete"]})]}),em.isStreaming&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"h-8 w-1 bg-primary/60 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),(0,a.jsx)("div",{className:"h-8 w-1 bg-primary/60 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),(0,a.jsx)("div",{className:"h-8 w-1 bg-primary/60 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),(0,a.jsx)("span",{children:"Audio is playing live..."})]})]}),(ed.isGenerating||em.isStreaming)&&(0,a.jsx)("div",{className:"flex gap-3 mb-6",children:"generate"===j?(0,a.jsxs)(u,{onClick:ed.handleCancel,variant:"destructive",size:"lg",className:"flex-1 hover:scale-[1.02] transition-transform",children:[(0,a.jsx)(ss.Z,{className:"h-4 w-4 mr-2"})," Cancel Generation"]}):(0,a.jsxs)(u,{onClick:()=>em.handleStopStreaming,variant:"destructive",className:"flex-1 gap-2 hover:scale-[1.02] transition-transform",size:"lg",children:[(0,a.jsx)(K.Z,{className:"h-4 w-4"})," Stop Streaming"]})}),!eg&&!eZ&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-muted/30 rounded-lg border-2 border-dashed border-muted-foreground/30",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,a.jsx)(e0.Z,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold mb-1",children:"Requirements Checklist"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Complete all requirements to generate audio"})]})]}),(0,a.jsxs)("ul",{className:"space-y-2",children:[(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 rounded transition-colors ".concat(g.trim()?"bg-green-500/10":"bg-muted/50"),children:[(0,a.jsx)("div",{className:"w-5 h-5 rounded-full flex items-center justify-center ".concat(g.trim()?"bg-green-500":"bg-muted-foreground/30"),children:g.trim()&&(0,a.jsx)(eQ.Z,{className:"h-3 w-3 text-white"})}),(0,a.jsx)("span",{className:"text-sm ".concat(g.trim()?"text-green-700 dark:text-green-400 font-medium":"text-muted-foreground"),children:"Enter text to convert"})]}),"single"===c?(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 rounded transition-colors ".concat(s?"bg-green-500/10":"bg-muted/50"),children:[(0,a.jsx)("div",{className:"w-5 h-5 rounded-full flex items-center justify-center ".concat(s?"bg-green-500":"bg-muted-foreground/30"),children:s&&(0,a.jsx)(eQ.Z,{className:"h-3 w-3 text-white"})}),(0,a.jsx)("span",{className:"text-sm ".concat(s?"text-green-700 dark:text-green-400 font-medium":"text-muted-foreground"),children:"Select a voice from sidebar"})]}):(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 rounded transition-colors ".concat(d.length>=2?"bg-green-500/10":"bg-muted/50"),children:[(0,a.jsx)("div",{className:"w-5 h-5 rounded-full flex items-center justify-center ".concat(d.length>=2?"bg-green-500":"bg-muted-foreground/30"),children:d.length>=2&&(0,a.jsx)(eQ.Z,{className:"h-3 w-3 text-white"})}),(0,a.jsx)("span",{className:"text-sm ".concat(d.length>=2?"text-green-700 dark:text-green-400 font-medium":"text-muted-foreground"),children:"Select at least 2 speakers"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 rounded transition-colors ".concat(n?"bg-green-500/10":"bg-muted/50"),children:[(0,a.jsx)("div",{className:"w-5 h-5 rounded-full flex items-center justify-center ".concat(n?"bg-green-500":"bg-muted-foreground/30"),children:n&&(0,a.jsx)(eQ.Z,{className:"h-3 w-3 text-white"})}),(0,a.jsx)("span",{className:"text-sm ".concat(n?"text-green-700 dark:text-green-400 font-medium":"text-muted-foreground"),children:"Complete server setup"})]})]})]}),"// in audio-generation.tsx",ex.isProcessing&&ex.jobs.length>0&&(0,a.jsxs)(el,{className:"mb-4 border-blue-500/50 bg-blue-500/10 text-blue-700 dark:text-blue-400 dark:border-blue-500 animate-in fade-in slide-in-from-top-2 duration-300",children:[(0,a.jsx)(se.Z,{className:"h-4 w-4 animate-spin"}),(0,a.jsxs)(en,{className:"font-medium",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{children:["Bulk Generation: ",Math.round(ex.jobs[0].progress),"% complete"]}),(0,a.jsxs)(v,{variant:"secondary",children:[ex.jobs[0].results.length," /"," ",ex.jobs[0].csvData.length," items"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(ea,{value:ex.jobs[0].progress,className:"flex-1"}),(0,a.jsxs)(u,{variant:"destructive",size:"sm",onClick:ex.cancelBulkGeneration,className:"gap-2",children:[(0,a.jsx)(ss.Z,{className:"h-4 w-4"}),"Cancel"]})]})]})]}),(0,a.jsx)(Z,{open:L,onOpenChange:O,children:(0,a.jsxs)(T,{children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{children:"Save as Template"})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Template Name"}),(0,a.jsx)(N,{placeholder:"Enter a name for this template...",value:V,onChange:e=>M(e.target.value),onKeyDown:e=>{"Enter"===e.key&&eN()}})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(u,{variant:"outline",onClick:()=>{O(!1),M("")},children:"Cancel"}),(0,a.jsxs)(u,{onClick:eN,disabled:!V.trim(),children:[(0,a.jsx)(e4.Z,{className:"h-4 w-4 mr-2"}),"Save Template"]})]})]})]})}),(0,a.jsx)(Z,{open:F,onOpenChange:D,children:(0,a.jsxs)(T,{className:"max-w-2xl",children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{children:"Load Template"})}),(0,a.jsx)(sr,{className:"max-h-[60vh]",children:0===_.length?(0,a.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,a.jsx)(e3.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"No saved templates yet"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Save your favorite text formats for quick access"})]}):(0,a.jsx)("div",{className:"space-y-3",children:_.map(e=>{var s;return(0,a.jsxs)("div",{className:"p-4 border rounded-lg hover:border-primary/50 transition-colors group",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)(v,{variant:"secondary",className:"text-xs",children:"single"===e.generationType?"Single Speaker":"".concat((null===(s=e.speakers)||void 0===s?void 0:s.length)||0," Speakers")}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsxs)(u,{variant:"ghost",size:"sm",onClick:()=>ey(e),children:[(0,a.jsx)(e3.Z,{className:"h-4 w-4 mr-2"}),"Load"]}),(0,a.jsx)(u,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity hover:bg-destructive/10 hover:text-destructive",onClick:()=>ew(e.id),children:(0,a.jsx)(eD.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"bg-muted/50 p-3 rounded text-sm font-mono max-h-24 overflow-hidden",children:[e.text.substring(0,200),e.text.length>200&&"..."]})]},e.id)})})})]})}),(0,a.jsx)(Z,{open:q,onOpenChange:X,children:(0,a.jsxs)(T,{children:[(0,a.jsx)(R,{children:(0,a.jsx)(P,{children:"Settings"})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Bulk Generation Delay (ms)"}),(0,a.jsx)(N,{type:"number",min:"0",max:"10000",step:"100",value:J,onChange:e=>Y(Number(e.target.value))}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Time to wait between bulk generation requests"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Show Character Count"}),(0,a.jsx)(u,{variant:$?"default":"outline",size:"sm",onClick:()=>Q(!$),children:$?"On":"Off"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Enter to Send"}),(0,a.jsx)(u,{variant:w?"default":"outline",size:"sm",onClick:()=>b(!w),children:w?"On":"Off"})]}),(0,a.jsx)("div",{className:"pt-4 border-t",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ctrl/Cmd + Enter always sends regardless of this setting"})})]})]})}),(0,a.jsx)(Z,{open:ee,onOpenChange:es,children:(0,a.jsxs)(T,{children:[(0,a.jsx)(R,{children:(0,a.jsxs)(P,{className:"flex items-center gap-2",children:[(0,a.jsx)(st.Z,{className:"h-5 w-5"})," OpenAI API Key Required"]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Voice recording and transcription requires an OpenAI API key. Please enter your key below. It will be saved in your browser's local storage."}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"openai-key",className:"text-sm font-medium",children:"Your OpenAI Key"}),(0,a.jsx)(N,{id:"openai-key",type:"password",placeholder:"sk-...",value:et,onChange:e=>er(e.target.value),onKeyDown:e=>{"Enter"===e.key&&eC()}})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(u,{variant:"outline",onClick:()=>es(!1),children:"Cancel"}),(0,a.jsxs)(u,{onClick:eC,disabled:!et.trim(),children:[(0,a.jsx)(e4.Z,{className:"h-4 w-4 mr-2"}),"Save Key"]})]})]})]})}),(0,a.jsx)(sj,{open:k,onOpenChange:C,currentText:g,onTextGenerated:f,speakerCount:"multi"===c?d.length:1}),(0,a.jsx)(sb,{open:S,onOpenChange:z,onStartBulkGeneration:ev})]})}var sz=t(8623);function s_(e){let{audioUrl:s,audioId:t,text:l,className:n,showDownload:i=!1,onDownload:c}=e,[d,m]=(0,r.useState)(!1),[h,p]=(0,r.useState)(0),[g,f]=(0,r.useState)(0),[j,v]=(0,r.useState)([1]),[N,y]=(0,r.useState)(!1),[w,b]=(0,r.useState)(!0),[k,C]=(0,r.useState)(""),[S,z]=(0,r.useState)(Array(32).fill(2)),[_,A]=(0,r.useState)(1),Z=(0,r.useRef)(null),U=(0,r.useRef)(null),E=(0,r.useRef)(null),F=(0,r.useRef)(null),T=(0,r.useRef)(null),R=(0,r.useRef)(null),P=(0,r.useRef)(1);(0,r.useEffect)(()=>{let e=Z.current;if(!e)return;let s=()=>{if(!E.current)try{let s=new(window.AudioContext||window.webkitAudioContext),t=s.createAnalyser();t.fftSize=512,t.smoothingTimeConstant=.8,t.minDecibels=-90,t.maxDecibels=-10;let a=s.createMediaElementSource(e);a.connect(t),t.connect(s.destination),E.current=s,F.current=t,T.current=a,R.current=new Uint8Array(t.frequencyBinCount)}catch(e){console.error("Failed to initialize audio context:",e),C("Audio visualization unavailable")}};return e.addEventListener("play",s,{once:!0}),()=>{var t,a;e.removeEventListener("play",s),(null===(t=E.current)||void 0===t?void 0:t.state)!=="closed"&&(null===(a=E.current)||void 0===a||a.close())}},[]),(0,r.useEffect)(()=>{let e=Z.current;if(!e)return;let s=()=>{f(e.duration),b(!1)},t=()=>p(e.currentTime),a=()=>m(!1),r=()=>m(!0),l=()=>m(!1),n=()=>{C("Failed to load audio"),b(!1)};return e.addEventListener("loadedmetadata",s),e.addEventListener("timeupdate",t),e.addEventListener("ended",a),e.addEventListener("play",r),e.addEventListener("pause",l),e.addEventListener("error",n),()=>{e.removeEventListener("loadedmetadata",s),e.removeEventListener("timeupdate",t),e.removeEventListener("ended",a),e.removeEventListener("play",r),e.removeEventListener("pause",l),e.removeEventListener("error",n)}},[]),(0,r.useEffect)(()=>{let e=F.current,s=R.current;if(d&&e&&s){let t=e.frequencyBinCount,a=Array.from({length:32},(e,s)=>Math.round(Math.exp((s+1)/32*Math.log(t-1))-1));a.unshift(0);let r=()=>{e.getByteFrequencyData(s);let t=Array.from({length:32},(e,t)=>{let r=a[t],l=a[t+1],n=s.slice(r,l);return 0===n.length?0:255*Math.pow(n.reduce((e,s)=>e+s,0)/n.length/255,2)/255*100});z(e=>e.map((e,s)=>{let a=t[s],r=a>e?.5:.8;return e*r+a*(1-r)})),U.current=requestAnimationFrame(r)};r()}else{U.current&&cancelAnimationFrame(U.current);let e=()=>{z(s=>{let t=s.map(e=>.9*e);return t.every(e=>e<2.1)?Array(32).fill(2):(U.current=requestAnimationFrame(e),t)})};U.current=requestAnimationFrame(e)}return()=>{U.current&&cancelAnimationFrame(U.current)}},[d]);let D=async()=>{let e=Z.current;if(e){if(d)e.pause();else try{var s;(null===(s=E.current)||void 0===s?void 0:s.state)==="suspended"&&await E.current.resume(),await e.play()}catch(e){console.error("Failed to play audio:",e),C("Failed to play audio")}}},I=e=>{let s=Z.current;s&&(s.playbackRate=e,A(e))},L=e=>isFinite(e)?"".concat(Math.floor(e/60),":").concat(Math.floor(e%60).toString().padStart(2,"0")):"0:00";return k&&w?(0,a.jsx)(x,{className:o("p-4",n),children:(0,a.jsx)("div",{className:"text-center text-sm text-destructive",children:k})}):(0,a.jsxs)(x,{className:o("p-4",n),children:[(0,a.jsx)("audio",{ref:Z,src:s,preload:"metadata",crossOrigin:"anonymous"}),(0,a.jsx)("div",{className:"mb-4 p-3 bg-muted/50 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm font-mono leading-relaxed line-clamp-3",children:l})}),(0,a.jsxs)("div",{className:"mb-4 p-4 bg-gradient-to-b from-black/5 to-black/10 dark:from-white/5 dark:to-white/10 rounded-lg",children:[(0,a.jsx)("div",{className:"flex items-end gap-[3px] h-20 justify-center",children:S.map((e,s)=>(0,a.jsx)("div",{className:o("bg-gradient-to-t from-primary/50 to-primary rounded-full transition-opacity duration-300 ease-out"),style:{width:"5px",height:"".concat(Math.max(2,e),"%"),opacity:d?1:.4}},s))}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-2",children:[(0,a.jsx)(eF.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:w?"Loading...":d?"Analyzing Audio":"Ready"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Q,{value:[g>0?h/g*100:0],onValueChange:e=>{let s=Z.current;if(!s||w)return;let t=e[0]/100*g;s.currentTime=t,p(t)},max:100,step:.1,className:"w-full",disabled:0===g||w}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:L(h)}),(0,a.jsx)("span",{children:L(g)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u,{onClick:D,disabled:0===g||w,size:"sm",className:"gap-2",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.Z,{className:"h-4 w-4"}),"Pause"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.Z,{className:"h-4 w-4"}),"Play"]})}),(0,a.jsxs)("select",{value:_,onChange:e=>I(Number(e.target.value)),className:"text-xs bg-secondary border border-input rounded px-2 py-1 h-8",disabled:w,children:[(0,a.jsx)("option",{value:.5,children:"0.5x"}),(0,a.jsx)("option",{value:.75,children:"0.75x"}),(0,a.jsx)("option",{value:1,children:"1x"}),(0,a.jsx)("option",{value:1.25,children:"1.25x"}),(0,a.jsx)("option",{value:1.5,children:"1.5x"}),(0,a.jsx)("option",{value:2,children:"2x"})]}),i&&(0,a.jsx)(u,{onClick:c,variant:"outline",size:"sm",className:"gap-2 ml-auto bg-transparent",children:(0,a.jsx)(sN.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,a.jsx)(u,{onClick:()=>{let e=Z.current;e&&(N?(e.volume=P.current,v([P.current]),y(!1)):(P.current=j[0],e.volume=0,v([0]),y(!0)))},variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:N||0===j[0]?(0,a.jsx)(sz.Z,{className:"h-4 w-4 text-muted-foreground"}):(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsx)(Q,{value:j,onValueChange:e=>{let s=Z.current;s&&(v(e),s.volume=e[0],e[0]>0&&N&&y(!1))},max:1,step:.01,className:"w-20",disabled:w})]})]}),k&&!w&&(0,a.jsx)("div",{className:"text-xs text-destructive text-center p-2 bg-destructive/10 rounded",children:k})]})]})}var sA=t(9270);function sZ(e){let{className:s,...t}=e;return(0,a.jsx)(sA.fC,{"data-slot":"checkbox",className:o("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:(0,a.jsx)(sA.z$,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(X.Z,{className:"size-3.5"})})})}var sU=t(2106);function sE(e){let{isOpen:s,onClose:t,audioUrl:l,audioId:n}=e,[i,c]=(0,r.useState)("wav"),[o,m]=(0,r.useState)("192"),[h,p]=(0,r.useState)("44100"),[g,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)(null),[N,y]=(0,r.useState)([30]),[b,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)(null),[z,_]=(0,r.useState)(!1),[A,U]=(0,r.useState)(null),[E,F]=(0,r.useState)("idle"),[I,L]=(0,r.useState)(""),[O,V]=(0,r.useState)(0),G=void 0!==window.pywebview,H=async()=>{F("exporting"),L(""),V(0);try{if(await (0,B.Vt)()&&(g||b||z)){if(g&&!j)throw Error("Please select a background music file");if(b&&!C)throw Error("Please select an intro file");if(z&&!A)throw Error("Please select an outro file");await K()}else await W();F("success"),setTimeout(()=>{t(),ee()},2e3)}catch(e){console.error("Export failed:",e),F("error"),L(e instanceof Error?e.message:"Failed to export audio. Please try again.")}},W=async()=>(V(50),new Promise((e,s)=>{let t=document.createElement("a");t.href=l,t.download="audio-".concat(n,".").concat(i),document.body.appendChild(t),t.click(),setTimeout(()=>{document.body.removeChild(t),V(100),e()},500)})),K=async()=>{var e,s;if(!(null===(s=window.pywebview)||void 0===s?void 0:null===(e=s.api)||void 0===e?void 0:e.export_audio))throw Error("Python backend not available. Advanced features require PyWebView.");V(20);let t=await fetch(l);if(!t.ok)throw Error("Failed to fetch audio file");let a=await t.blob();V(40);let r=await $(a);V(50);let c=g&&j?await $(j):null,d=b&&C?await $(C):null,m=z&&A?await $(A):null;V(70);let u=await window.pywebview.api.export_audio({main_audio:r,format:i,bitrate:Number.parseInt(o),sample_rate:Number.parseInt(h),background_music:c,background_volume:N[0]/100,intro:d,outro:m,output_filename:"audio-".concat(n,".").concat(i)});if(V(100),!u.success)throw Error(u.error||"Export failed")},q=e=>{v(e)},X=e=>{S(e)},J=e=>{U(e)},Y=async e=>{try{let s=await window.pywebview.api.select_audio_file();if(s.success){let t=d(s.file_data,s.filename,s.mime_type);switch(e){case"bgmusic":v(t);break;case"intromusic":S(t);break;case"outromusic":U(t)}}else console.error("File selection failed:",s.error)}catch(e){console.error("Error calling pywebview API:",e)}},$=e=>new Promise((s,t)=>{let a=new FileReader;a.onloadend=()=>{s(a.result.split(",")[1])},a.onerror=()=>t(Error("Failed to read file")),a.readAsDataURL(e)}),ee=()=>{F("idle"),L(""),V(0),v(null),S(null),U(null)},es=e=>{let s=e.size/1048576;return s<1?"".concat((e.size/1024).toFixed(1)," KB"):"".concat(s.toFixed(2)," MB")};return(0,a.jsx)(Z,{open:s,onOpenChange:t,children:(0,a.jsxs)(T,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(R,{children:[(0,a.jsxs)(P,{className:"flex items-center gap-2",children:[(0,a.jsx)(sN.Z,{className:"h-5 w-5"}),"Export Audio"]}),(0,a.jsx)(D,{children:"Configure export settings and add optional audio layers"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:["success"===E&&(0,a.jsxs)(el,{className:"border-green-500 bg-green-50 dark:bg-green-950",children:[(0,a.jsx)(eQ.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)(en,{className:"text-green-800 dark:text-green-200",children:"Audio exported successfully!"})]}),"error"===E&&(0,a.jsxs)(el,{variant:"destructive",children:[(0,a.jsx)(e0.Z,{className:"h-4 w-4"}),(0,a.jsx)(en,{children:I})]}),I&&"idle"===E&&(0,a.jsxs)(el,{variant:"destructive",children:[(0,a.jsx)(e0.Z,{className:"h-4 w-4"}),(0,a.jsx)(en,{children:I})]}),(0,a.jsxs)(x,{className:"p-4 space-y-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4"}),"Format Settings"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{children:"Format"}),(0,a.jsxs)(eB,{value:i,onValueChange:e=>c(e),children:[(0,a.jsx)(eW,{children:(0,a.jsx)(eH,{})}),(0,a.jsxs)(eK,{children:[(0,a.jsx)(eq,{value:"wav",children:"WAV (Lossless)"}),(0,a.jsx)(eq,{value:"mp3",children:"MP3 (Compressed)"}),(0,a.jsx)(eq,{value:"ogg",children:"OGG (Compressed)"})]})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["wav"===i&&"Best quality, larger file size","mp3"===i&&"Good quality, smaller file size","ogg"===i&&"Open format, good compression"]})]}),"wav"!==i&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{children:"Bitrate (kbps)"}),(0,a.jsxs)(eB,{value:o,onValueChange:m,children:[(0,a.jsx)(eW,{children:(0,a.jsx)(eH,{})}),(0,a.jsxs)(eK,{children:[(0,a.jsx)(eq,{value:"128",children:"128 kbps (Small)"}),(0,a.jsx)(eq,{value:"192",children:"192 kbps (Standard)"}),(0,a.jsx)(eq,{value:"256",children:"256 kbps (High)"}),(0,a.jsx)(eq,{value:"320",children:"320 kbps (Best)"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{children:"Sample Rate (Hz)"}),(0,a.jsxs)(eB,{value:h,onValueChange:p,children:[(0,a.jsx)(eW,{children:(0,a.jsx)(eH,{})}),(0,a.jsxs)(eK,{children:[(0,a.jsx)(eq,{value:"22050",children:"22050 Hz (Voice)"}),(0,a.jsx)(eq,{value:"44100",children:"44100 Hz (CD Quality)"}),(0,a.jsx)(eq,{value:"48000",children:"48000 Hz (Professional)"})]})]})]})]})]}),(0,a.jsxs)(x,{className:"p-4 space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sZ,{checked:g,onCheckedChange:e=>f(e)}),(0,a.jsxs)(w,{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)(sU.Z,{className:"h-4 w-4"}),"Add Background Music"]})]})}),g&&(0,a.jsxs)("div",{className:"space-y-3 pl-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{htmlFor:"bg-music-input",className:"text-xs",children:"Background Music File"}),G?(0,a.jsx)(u,{onClick:()=>Y("bgmusic"),variant:"outline",className:"w-full",children:"Select Audio File..."}):(0,a.jsx)("input",{id:"bg-music-input",type:"file",accept:"audio/*",onChange:e=>{var s;return q((null===(s=e.target.files)||void 0===s?void 0:s[0])||null)},className:"text-sm w-full"}),j&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1 mt-2",children:[(0,a.jsxs)("p",{children:["\uD83D\uDCC1 ",j.name]}),(0,a.jsxs)("p",{children:["\uD83D\uDCBE ",es(j)]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(w,{className:"text-xs",children:"Background Volume"}),(0,a.jsxs)("span",{className:"text-xs font-mono text-muted-foreground",children:[N[0],"%"]})]}),(0,a.jsx)(Q,{value:N,onValueChange:y,max:100,step:1}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Adjust the volume of background music relative to main audio"})]})]})]}),(0,a.jsxs)(x,{className:"p-4 space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold",children:"Intro & Outro"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sZ,{checked:b,onCheckedChange:e=>k(e)}),(0,a.jsx)(w,{className:"cursor-pointer",children:"Add Intro"})]}),b&&(0,a.jsxs)("div",{className:"pl-6 space-y-2",children:[G?(0,a.jsx)(u,{onClick:()=>Y("intromusic"),variant:"outline",className:"w-full",children:"Select Audio File..."}):(0,a.jsx)("input",{id:"intro-input",type:"file",accept:"audio/*",onChange:e=>{var s;return X((null===(s=e.target.files)||void 0===s?void 0:s[0])||null)},className:"text-sm w-full"}),C&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("p",{children:["\uD83D\uDCC1 ",C.name]}),(0,a.jsxs)("p",{children:["\uD83D\uDCBE ",es(C)]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sZ,{checked:z,onCheckedChange:e=>_(e)}),(0,a.jsx)(w,{className:"cursor-pointer",children:"Add Outro"})]}),z&&(0,a.jsxs)("div",{className:"pl-6 space-y-2",children:[G?(0,a.jsx)(u,{onClick:()=>Y("outromusic"),variant:"outline",className:"w-full",children:"Select Audio File..."}):(0,a.jsx)("input",{id:"bg-music-input",type:"file",accept:"audio/*",onChange:e=>{var s;return J((null===(s=e.target.files)||void 0===s?void 0:s[0])||null)},className:"text-sm w-full"}),A&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("p",{children:["\uD83D\uDCC1 ",A.name]}),(0,a.jsxs)("p",{children:["\uD83D\uDCBE ",es(A)]})]})]})]})]})]}),"exporting"===E&&(0,a.jsx)(x,{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Exporting..."}),(0,a.jsxs)("span",{className:"font-mono",children:[O,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:"".concat(O,"%")}})})]})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(u,{onClick:t,variant:"outline",className:"flex-1 bg-transparent",disabled:"exporting"===E,children:"success"===E?"Close":"Cancel"}),(0,a.jsx)(u,{onClick:H,className:"flex-1 gap-2",disabled:"exporting"===E||"success"===E,children:"exporting"===E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(se.Z,{className:"h-4 w-4 animate-spin"}),"Exporting..."]}):"success"===E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eQ.Z,{className:"h-4 w-4"}),"Exported"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sN.Z,{className:"h-4 w-4"}),"Export Audio"]})})]})]})]})})}var sF=t(5621);function sT(){let{generatedAudios:e,voices:s,removeGeneratedAudio:t}=(0,I.m)(),[l,n]=(0,r.useState)(!1),[i,c]=(0,r.useState)(null),o=async e=>{if(confirm("Are you sure you want to delete this audio?"))try{await t(e)}catch(e){console.error("Failed to delete audio:",e)}},d=(e,s)=>{c({url:e,id:s}),n(!0)};return 0===e.length?(0,a.jsxs)(x,{className:"p-6 text-center",children:[(0,a.jsx)(sF.Z,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No generated audio yet"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Generated audio will appear here"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sF.Z,{className:"h-5 w-5"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Generated Audio"}),(0,a.jsx)(v,{variant:"secondary",children:e.length})]}),e.length>1&&(0,a.jsxs)(u,{onClick:()=>{e.forEach(e=>{let s=document.createElement("a");s.href=e.audioUrl,s.download="DeepFak3r-".concat(e.id,".wav"),document.body.appendChild(s),s.click(),document.body.removeChild(s)})},variant:"outline",size:"sm",className:"gap-2 bg-transparent",children:[(0,a.jsx)(sN.Z,{className:"h-4 w-4"}),"Download All"]})]}),(0,a.jsx)("div",{className:"space-y-4",children:e.slice().reverse().map(e=>{let t=s.find(s=>s.id===e.voiceId),r=null==t?void 0:t.emotions.find(s=>s.id===e.emotionId);return(0,a.jsxs)("div",{className:"space-y-2 p-4 rounded-lg border bg-background",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:(null==t?void 0:t.name)||"Unknown Voice"}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:""}),(0,a.jsx)("span",{children:r.name})]}),(0,a.jsx)("span",{children:""}),(0,a.jsx)("span",{children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(u,{onClick:()=>d(e.audioUrl,e.id),variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-muted-foreground hover:text-primary",title:"Export with options",children:(0,a.jsx)(sN.Z,{className:"h-4 w-4"})}),(0,a.jsx)(u,{onClick:()=>o(e.id),variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-muted-foreground hover:text-destructive",children:(0,a.jsx)(eD.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(s_,{audioUrl:e.audioUrl,audioId:e.id,text:e.text})]},e.id)})}),e.length>0&&(0,a.jsx)(x,{className:"p-4 bg-muted/50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Total: ",e.length," audio files"]}),(0,a.jsxs)("span",{children:["Storage: ~",Math.round(1.2*e.length),"MB estimated"]})]})})]}),i&&(0,a.jsx)(sE,{isOpen:l,onClose:()=>{n(!1),c(null)},audioUrl:i.url,audioId:i.id})]})}var sR=t(7586),sP=t(2682),sD=t(8239),sI=t(6858);function sL(e){let{onContinue:s}=e;return(0,a.jsxs)(sD.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-8 text-center",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(sD.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-primary to-accent",children:(0,a.jsx)(sx.Z,{className:"w-10 h-10 text-white"})}),(0,a.jsx)("h2",{className:"text-3xl font-bold text-balance",children:"Welcome to DeepFak3r Voice Cloning App! \uD83C\uDF99"}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground text-pretty max-w-md mx-auto",children:"Let's get you set up in just a few simple steps. We'll help you find the perfect way to run your voice cloning magic."})]}),(0,a.jsxs)("div",{className:"grid gap-4 max-w-sm mx-auto text-left",children:[(0,a.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold",children:"1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:"Verify Your License"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Quick and easy activation"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold",children:"2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:"Check Your Hardware"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"We'll recommend the best setup for you"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold",children:"3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:"Start Creating"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Clone voices and generate speech!"})]})]})]}),(0,a.jsxs)(u,{onClick:s,size:"lg",className:"gap-2",children:["Let's Get Started",(0,a.jsx)(sI.Z,{className:"w-4 h-4"})]})]})}var sO=t(6362);function sV(e){let{licenseInput:s,setLicenseInput:t,licenseError:r,isSubmitting:l,onSubmit:n}=e;return(0,a.jsxs)(sD.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-2",children:(0,a.jsx)(sf.Z,{className:"w-8 h-8 text-primary"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Activate Your License"}),(0,a.jsx)("p",{className:"text-muted-foreground text-pretty",children:"Enter your license key to unlock all features"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{htmlFor:"license-key",children:"License Key"}),(0,a.jsx)(N,{id:"license-key",value:s,onChange:e=>t(e.target.value),placeholder:"XXXX-XXXX-XXXX-XXXX",className:"font-mono text-center text-lg",autoFocus:!0,onKeyDown:e=>"Enter"===e.key&&n()})]}),r&&(0,a.jsx)(el,{variant:"destructive",children:(0,a.jsx)(en,{children:r})}),(0,a.jsx)(u,{onClick:n,disabled:!s.trim()||l,className:"w-full",size:"lg",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(se.Z,{className:"w-4 h-4 animate-spin mr-2"}),"Activating..."]}):"Save and Continue"}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("a",{href:"https://gumroad.com/library",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline inline-flex items-center gap-1",children:[(0,a.jsx)(sO.Z,{className:"w-3 h-3"}),"Find my license key"]})})]})]})}function sM(){return(0,a.jsxs)(sD.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-6 text-center",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-primary/10",children:(0,a.jsx)(sD.E.div,{animate:{rotate:360},transition:{duration:2,repeat:Number.POSITIVE_INFINITY,ease:"linear"},children:(0,a.jsx)(e_.Z,{className:"w-10 h-10 text-primary"})})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Analyzing Your System"}),(0,a.jsx)("p",{className:"text-muted-foreground text-pretty max-w-md mx-auto",children:"We're checking your hardware to recommend the best setup for you. This will only take a moment..."})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)(se.Z,{className:"w-4 h-4 animate-spin text-primary"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Detecting GPUs and system specs"})]})]})}var sG=t(9897),sB=t(8906),sH=t(9202),sW=t(1341);function sK(e){let{hardwareInfo:s,onChooseLocal:t,onChooseRemote:r,onChooseRunPod:l}=e,n="local"===s.recommendedSetup,i="runpod"===s.recommendedSetup,c=s.gpus.length>0&&s.totalVRAM>=8;return(0,a.jsxs)(sD.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Choose Your Setup"}),(0,a.jsx)("p",{className:"text-muted-foreground text-pretty",children:"Based on your hardware, here are your options"})]}),(0,a.jsx)(x,{className:"p-4 bg-muted/50",children:(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-primary",children:s.gpus.length}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["GPU",1!==s.gpus.length?"s":""]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-primary",children:[s.totalVRAM,"GB"]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Total VRAM"})]}),(0,a.jsx)("div",{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-primary capitalize",children:s.os}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"OS"})]})]})}),(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsx)(sc,{delayDuration:150,children:(0,a.jsxs)(so,{children:[(0,a.jsx)(sd,{asChild:!0,className:"w-full",children:(0,a.jsx)(sD.E.div,{whileHover:c?{scale:1.02}:{},whileTap:c?{scale:.98}:{},children:(0,a.jsx)(x,{className:o("p-6 text-left transition-all w-full",n&&"border-primary bg-primary/5",c?"cursor-pointer hover:border-primary/50":"opacity-60 cursor-not-allowed bg-muted/30"),onClick:c?t:void 0,children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(sG.Z,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Local Setup"}),n&&(0,a.jsxs)(v,{className:"bg-green-600 text-white gap-1.5",children:[(0,a.jsx)(sx.Z,{className:"w-3 h-3 mr-1"}),"Recommended"]})]}),!c&&(0,a.jsxs)(v,{variant:"destructive",className:"gap-1.5",children:[(0,a.jsx)(e0.Z,{className:"w-3.5 h-3.5"}),"Unavailable"]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Run everything on your computer. Fast, private, and no ongoing costs."}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 pt-2",children:[(0,a.jsxs)(v,{variant:"outline",className:"gap-1",children:[(0,a.jsx)(eZ.Z,{className:"w-3 h-3"}),"Fastest"]}),(0,a.jsxs)(v,{variant:"outline",className:"gap-1",children:[(0,a.jsx)(sB.Z,{className:"w-3 h-3"}),"Most Private"]})]})]})]})})})}),!c&&(0,a.jsx)(sm,{children:(0,a.jsx)("p",{children:"Requires a dedicated GPU and at least 8GB of RAM."})})]})}),(0,a.jsx)(sD.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,a.jsx)(x,{className:"p-6 cursor-pointer hover:border-primary/50 transition-all",onClick:r,children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-muted flex items-center justify-center",children:(0,a.jsx)(sH.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Custom Server"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Connect to your own server or a friend's setup."})]})]})})}),(0,a.jsx)(sD.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,a.jsx)(x,{className:"p-6 cursor-pointer transition-all ".concat(i?"border-primary bg-primary/5":"hover:border-primary/50"),onClick:l,children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(sW.Z,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Cloud (RunPod)"}),i&&(0,a.jsxs)(v,{className:"bg-green-600 text-white gap-1.5",children:[(0,a.jsx)(sx.Z,{className:"w-3 h-3 mr-1"}),"Recommended"]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Rent powerful cloud GPUs. Perfect if your computer doesn't have enough power."}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"~$0.50-2.00/hour  Pay only when using"})]})]})})})]})]})}function sq(e){let{downloadProgress:s,onStart:t,onBack:r}=e,l=s&&"error"!==s.stage&&"complete"!==s.stage;return(0,a.jsxs)(sD.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-2",children:(0,a.jsx)(sN.Z,{className:"w-8 h-8 text-primary"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Local Server Setup"}),(0,a.jsx)("p",{className:"text-muted-foreground text-pretty max-w-md mx-auto",children:"We'll download and install everything you need. This might take a few minutes."})]}),s&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:["error"===s.stage?(0,a.jsx)(e0.Z,{className:"w-5 h-5 text-destructive flex-shrink-0"}):"complete"===s.stage?(0,a.jsx)(ej.Z,{className:"w-5 h-5 text-accent flex-shrink-0"}):(0,a.jsx)(se.Z,{className:"w-5 h-5 animate-spin text-primary flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:s.message})]}),l&&(0,a.jsx)(ea,{value:s.progress,className:"h-2"}),s.error&&(0,a.jsx)(el,{variant:"destructive",children:(0,a.jsx)(en,{children:s.error})})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[!l&&(0,a.jsx)(u,{variant:"outline",onClick:r,className:"flex-1 bg-transparent",children:"Back"}),(0,a.jsx)(u,{onClick:t,disabled:l,className:"flex-1",size:"lg",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(se.Z,{className:"w-4 h-4 animate-spin mr-2"}),"Setting Up..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sN.Z,{className:"w-4 h-4 mr-2"}),"Start Setup"]})})]})]})}function sX(e){let{customUrl:s,setCustomUrl:t,isSubmitting:l,onSubmit:n,onBack:i}=e,[c,o]=(0,r.useState)(!1);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(sD.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-2",children:(0,a.jsx)(sH.Z,{className:"w-8 h-8 text-primary"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Connect to Server"}),(0,a.jsx)("p",{className:"text-muted-foreground text-pretty max-w-md mx-auto",children:"Enter the URL of your voice cloning server"})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)(Z,{open:c,onOpenChange:o,children:[(0,a.jsx)(U,{children:(0,a.jsxs)(u,{variant:"secondary",size:"lg",className:"w-full max-w-sm",children:[(0,a.jsx)(e0.Z,{className:"w-4 h-4 mr-2"}),"Try Test Server (Free GPU Demo)"]})}),(0,a.jsxs)(T,{className:"max-w-md",children:[(0,a.jsxs)(R,{children:[(0,a.jsx)(P,{children:"Try a Free Test Server"}),(0,a.jsx)(D,{children:(0,a.jsx)("p",{className:"text-sm mb-4",children:"This will allow you to rent a free GPU instance on Google Colab. It's just for demo purposes and you cannot generate audio more than one minute. For something serious, you should consider using cloud mode or running locally if you have the compute power."})})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(u,{asChild:!0,variant:"default",onClick:()=>o(!1),children:(0,a.jsx)("a",{href:"https://colab.research.google.com/drive/17sHxevm2nI1FaIsSn9Sfk-hCi0-gkpVn?usp=sharing",target:"_blank",rel:"noopener noreferrer",children:"Open Google Colab"})})})]})]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{htmlFor:"server-url",children:"Server URL"}),(0,a.jsx)(N,{id:"server-url",value:s,onChange:e=>t(e.target.value),placeholder:"https://your-server.com:8000",autoFocus:!0,onKeyDown:e=>"Enter"===e.key&&n()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Example: http://localhost:8000 or https://my-server.com"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(u,{variant:"outline",onClick:i,className:"flex-1 bg-transparent",children:"Back"}),(0,a.jsx)(u,{onClick:n,disabled:!s.trim()||l,className:"flex-1",size:"lg",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(se.Z,{className:"w-4 h-4 animate-spin mr-2"}),"Connecting..."]}):"Connect"})]})]})]})})}function sJ(e){let{runpodApiKey:s,setRunpodApiKey:t,deploymentProgress:r,onDeploy:l,onBack:n}=e,i=r&&"error"!==r.stage&&"ready"!==r.stage;return(0,a.jsxs)(sD.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-2",children:(0,a.jsx)(sW.Z,{className:"w-8 h-8 text-primary"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Deploy to Cloud"}),(0,a.jsx)("p",{className:"text-muted-foreground text-pretty max-w-md mx-auto",children:"Rent a powerful GPU in the cloud for optimal performance"})]}),(0,a.jsx)(el,{className:"bg-primary/5 border-primary/20",children:(0,a.jsxs)(en,{className:"text-sm",children:[(0,a.jsx)("strong",{children:"Cost:"})," Approximately $0.50-2.00/hour for high-end GPUs. The server will automatically stop when you close the app."]})}),!r&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w,{htmlFor:"runpod-key",children:"RunPod API Key"}),(0,a.jsx)(N,{id:"runpod-key",type:"password",value:s,onChange:e=>t(e.target.value),placeholder:"Enter your API key",autoFocus:!0}),(0,a.jsxs)("a",{href:"https://www.runpod.io/console/user/settings/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline inline-flex items-center gap-1",children:[(0,a.jsx)(sO.Z,{className:"w-3 h-3"}),"Get your API key from RunPod"]})]})}),r&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:["error"===r.stage?(0,a.jsx)(e0.Z,{className:"w-5 h-5 text-destructive flex-shrink-0"}):"ready"===r.stage?(0,a.jsx)(ej.Z,{className:"w-5 h-5 text-accent flex-shrink-0"}):(0,a.jsx)(se.Z,{className:"w-5 h-5 animate-spin text-primary flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:r.message})]}),i&&(0,a.jsx)(ea,{value:r.progress,className:"h-2"}),r.error&&(0,a.jsx)(el,{variant:"destructive",children:(0,a.jsx)(en,{children:r.error})})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[!i&&(0,a.jsx)(u,{variant:"outline",onClick:n,className:"flex-1 bg-transparent",children:"Back"}),(0,a.jsx)(u,{onClick:l,disabled:!s.trim()||i,className:"flex-1",size:"lg",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(se.Z,{className:"w-4 h-4 animate-spin mr-2"}),"Deploying..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sW.Z,{className:"w-4 h-4 mr-2"}),"Deploy Server"]})})]})]})}function sY(e){let{serverConfig:s,onFinish:t}=e;return(0,a.jsxs)(sD.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-6 text-center",children:[(0,a.jsx)(sD.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-accent to-primary",children:(0,a.jsx)(ej.Z,{className:"w-10 h-10 text-white"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:"You're All Set! \uD83C\uDF89"}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground text-pretty max-w-md mx-auto",children:"Your voice cloning server is ready. Time to create some amazing voices!"})]}),s&&(0,a.jsx)(x,{className:"p-6 bg-muted/50 text-left max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Server Type"}),(0,a.jsx)(v,{variant:"outline",className:"capitalize",children:s.type})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Status"}),(0,a.jsxs)(v,{className:"bg-accent gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-white rounded-full"}),"Online"]})]}),(0,a.jsxs)("div",{className:"pt-2 border-t",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Server URL"}),(0,a.jsx)("div",{className:"text-xs font-mono bg-background p-2 rounded mt-1 break-all",children:s.url})]})]})}),(0,a.jsxs)(u,{onClick:t,size:"lg",className:"gap-2",children:[(0,a.jsx)(sx.Z,{className:"w-4 h-4"}),"Start Creating Voices"]})]})}function s$(){let{isServerSetupComplete:e}=(0,I.m)(),{currentStep:s,setCurrentStep:t,licenseInput:l,setLicenseInput:n,licenseError:i,isSubmitting:c,customUrl:o,setCustomUrl:d,runpodApiKey:m,setRunpodApiKey:h,downloadProgress:p,deploymentProgress:g,hardwareInfo:j,serverConfig:v,handleLicenseSubmit:N,handleLocalSetup:y,handleRemoteSetup:w,handleRunPodSetup:b,handleSkip:k}=function(){let{hardwareInfo:e,serverConfig:s,licenseKey:t,checkHardware:a,setServerConfig:l,checkServerHealth:n,setLicenseKey:i,deployToRunPod:c}=(0,I.m)(),[o,d]=(0,r.useState)("welcome"),[m,u]=(0,r.useState)(t||""),[x,h]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),[f,j]=(0,r.useState)(""),[v,N]=(0,r.useState)(""),[y,w]=(0,r.useState)(null),[b,k]=(0,r.useState)(null),[C,S]=(0,r.useState)(null),[z,_]=(0,r.useState)(null),A=(0,r.useRef)(!1),Z=(0,r.useRef)(null);(0,r.useEffect)(()=>{t&&d("hardware-check")},[t]),(0,r.useEffect)(()=>{"hardware-check"===o&&e&&!e.isChecking&&d("choose-setup")},[o,e]),(0,r.useEffect)(()=>{if((null==e?void 0:e.recommendedSetup)==="local"&&!C){let e=sP.Yg.getInstance();e.setProgressCallback(w),S(e)}return()=>{Z.current&&clearInterval(Z.current)}},[e,C]),(0,r.useEffect)(()=>{if(!C)return;if(!(null!==y||(null==s?void 0:s.type)==="local")){Z.current&&(clearInterval(Z.current),Z.current=null);return}let e=async()=>{try{let e=await C.getServerInfo();_(e)}catch(e){console.error("Failed to get server info:",e)}};return e(),Z.current=setInterval(e,3e3),()=>{Z.current&&clearInterval(Z.current)}},[C,y,s]),(0,r.useEffect)(()=>{let s=async s=>{let t=s.detail;if(k(t),"ready"===t.stage&&t.url&&t.podId){var a,r;(null===(r=window.pywebview)||void 0===r?void 0:null===(a=r.api)||void 0===a?void 0:a.set_active_runpod_instance)&&await window.pywebview.api.set_active_runpod_instance(v.trim(),t.podId);let s={type:"runpod",url:t.url,current_model:null,cpu_usage:0,gpu_available:(null==e?void 0:e.hasGPU)||!1,gpu_memory_usage:null,gpu_utilization:null,model_loaded:!1,ram_usage_percent:0,warmup_complete:!1,status:"checking"};await l(s),await n()&&d("complete")}};return window.addEventListener("runpod-progress",s),()=>window.removeEventListener("runpod-progress",s)},[l,n,v,e]);let U=(0,r.useCallback)(async()=>{if(!m.trim()){h("Please enter your license key");return}g(!0),h("");try{await i(m.trim()),d("hardware-check"),a()}catch(e){h("Failed to save license key. Please try again.")}finally{g(!1)}},[m,i,a]),E=(0,r.useCallback)(async()=>{if(C&&e&&!A.current){A.current=!0,d("local-setup");try{await C.setupLocalServer();let s=0,t=1e3;for(;s<20;){try{if((await C.getServerInfo()).isRunning){let s={type:"local",url:C.getServerUrl(),current_model:null,cpu_usage:0,gpu_available:e.hasGPU,gpu_memory_usage:null,gpu_utilization:null,model_loaded:!1,ram_usage_percent:0,warmup_complete:!1,status:"checking"};if(await l(s),await n()){w(null),d("complete");return}}}catch(e){console.warn("Server check failed (attempt ".concat(s+1,"/").concat(20,")"))}await new Promise(e=>setTimeout(e,Math.min(t,5e3))),t*=1.5,s++}throw Error("Server failed to become ready")}catch(e){console.error("Setup failed:",e),w({stage:"error",progress:0,message:"Setup failed",error:e instanceof Error?e.message:"Unknown error"})}finally{A.current=!1}}},[C,e,l,n]),F=(0,r.useCallback)(async()=>{if(!f.trim())return;let s=function(e){try{let s=new URL(e);if(!["http:","https:"].includes(s.protocol))return{isValid:!1,error:"URL must use HTTP or HTTPS protocol"};if(!s.hostname)return{isValid:!1,error:"URL must have a valid hostname"};let t="".concat(s.protocol,"//").concat(s.hostname).concat(s.port?":".concat(s.port):"");return{isValid:!0,normalizedUrl:t}}catch(e){return{isValid:!1,error:"Invalid URL format"}}}(f.trim());if(!s.isValid){alert(s.error||"Invalid URL format");return}g(!0),d("remote-setup");try{let t={type:"remote",url:s.normalizedUrl,current_model:null,cpu_usage:0,gpu_available:(null==e?void 0:e.hasGPU)||!1,gpu_memory_usage:null,gpu_utilization:null,model_loaded:!1,ram_usage_percent:0,warmup_complete:!1,status:"checking"};await l(t),await n()?d("complete"):(alert("Server is not reachable. Please check the URL and try again."),d("choose-setup"))}catch(e){alert("Failed to connect: ".concat(e.message)),d("choose-setup")}finally{g(!1)}},[f,e,l,n]),T=(0,r.useCallback)(async()=>{v.trim()&&(d("runpod-setup"),k({stage:"validating",progress:0,message:"Initializing deployment..."}),await c(v.trim(),k))},[v,c]);return{currentStep:o,setCurrentStep:d,licenseInput:m,setLicenseInput:u,licenseError:x,isSubmitting:p,customUrl:f,setCustomUrl:j,runpodApiKey:v,setRunpodApiKey:N,downloadProgress:y,deploymentProgress:b,serverInfo:z,hardwareInfo:e,serverConfig:s,handleLicenseSubmit:U,handleLocalSetup:E,handleRemoteSetup:F,handleRunPodSetup:T,handleSkip:(0,r.useCallback)(()=>{I.m.setState({isServerSetupComplete:!0})},[])}}();return e?null:(0,a.jsx)("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(x,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto relative",children:["welcome"!==s&&"complete"!==s&&(0,a.jsx)(u,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 z-10",onClick:k,children:(0,a.jsx)(A.Z,{className:"w-4 h-4"})}),(0,a.jsx)(f,{className:"p-8",children:(0,a.jsxs)(sR.M,{mode:"wait",children:["welcome"===s&&(0,a.jsx)(sL,{onContinue:()=>t("license")},"welcome"),"license"===s&&(0,a.jsx)(sV,{licenseInput:l,setLicenseInput:n,licenseError:i,isSubmitting:c,onSubmit:N},"license"),"hardware-check"===s&&(0,a.jsx)(sM,{},"hardware-check"),"choose-setup"===s&&j&&(0,a.jsx)(sK,{hardwareInfo:j,onChooseLocal:y,onChooseRemote:()=>t("remote-setup"),onChooseRunPod:()=>t("runpod-setup")},"choose-setup"),"local-setup"===s&&(0,a.jsx)(sq,{downloadProgress:p,onStart:y,onBack:()=>t("choose-setup")},"local-setup"),"remote-setup"===s&&(0,a.jsx)(sX,{customUrl:o,setCustomUrl:d,isSubmitting:c,onSubmit:w,onBack:()=>t("choose-setup")},"remote-setup"),"runpod-setup"===s&&(0,a.jsx)(sJ,{runpodApiKey:m,setRunpodApiKey:h,deploymentProgress:g,onDeploy:b,onBack:()=>t("choose-setup")},"runpod-setup"),"complete"===s&&(0,a.jsx)(sY,{serverConfig:v,onFinish:()=>{I.m.setState({isServerSetupComplete:!0})}},"complete")]})}),"welcome"!==s&&"complete"!==s&&(0,a.jsx)("div",{className:"flex items-center justify-center gap-2 pb-6",children:["license","hardware-check","choose-setup","local-setup","remote-setup","runpod-setup"].map((e,t)=>(0,a.jsx)("div",{className:"h-1.5 rounded-full transition-all ".concat(["license","hardware-check"].includes(s)&&0===t?"w-8 bg-primary":["choose-setup","local-setup","remote-setup","runpod-setup"].includes(s)&&1===t?"w-8 bg-primary":t<(["license","hardware-check"].includes(s)?1:2)?"w-8 bg-primary":"w-2 bg-muted")},e))})]})})}function sQ(){let{isLoading:e}=(0,I.m)();return e?(0,a.jsx)("div",{className:"flex h-screen bg-background grid-pattern items-center justify-center",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(se.Z,{className:"h-6 w-6 animate-spin"}),(0,a.jsx)("span",{className:"text-lg",children:"Loading DeepFak3r..."})]})}):(0,a.jsxs)("div",{className:"flex h-screen bg-background grid-pattern",children:[(0,a.jsx)(eI,{}),(0,a.jsx)("main",{className:"flex-1 p-6 overflow-y-auto",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"DeepFak3r VibeVoice"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["\uD83C\uDFA4 Transform"," ",(0,a.jsx)("span",{className:"font-semibold text-primary underline decoration-wavy ",children:"any Text"})," ","into"," ",(0,a.jsx)("span",{className:"font-semibold text-primary underline decoration-wavy ",children:"any Voice"}),"with DeepFak3r vibevoice! "]})]}),(0,a.jsxs)("div",{className:"grid gap-6",children:[(0,a.jsx)(sS,{}),(0,a.jsx)(sT,{})]})]})}),(0,a.jsx)(s$,{})]})}}},function(e){e.O(0,[422,97,971,117,744],function(){return e(e.s=5573)}),_N_E=e.O()}]);